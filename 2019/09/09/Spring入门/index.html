<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="English">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/blog/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/blog/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/blog/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/blog/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Spring 入门,">










<meta name="description" content="久仰Spring MVC大名，现在公司要求学习Spring框架，打算借这个机会将Spring系列的东西学习一遍。接下来的学习任务:  Spring  Spring boot Mybatis  参考资料: [1] W3Cschool Spring 教程 本文CSDN地址: #Spring 学习#入门 这篇文章的项目代码地址：Spring-Demo">
<meta name="keywords" content="Spring 入门">
<meta property="og:type" content="article">
<meta property="og:title" content="Spring入门">
<meta property="og:url" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/index.html">
<meta property="og:site_name" content="GT Blog">
<meta property="og:description" content="久仰Spring MVC大名，现在公司要求学习Spring框架，打算借这个机会将Spring系列的东西学习一遍。接下来的学习任务:  Spring  Spring boot Mybatis  参考资料: [1] W3Cschool Spring 教程 本文CSDN地址: #Spring 学习#入门 这篇文章的项目代码地址：Spring-Demo">
<meta property="og:locale" content="English">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/arch1.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/helloworld-project.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/helloworld-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/ioc1.jpg">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/XmlBeanfactory-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/FileSystemXmlApplicationContext-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/bean-spring-relation.jpg">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/scopedemo-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/BeanLifeCircleDemo-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/BeanPostProcessor-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/BeanExtendsDemo-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/ConstrcutorBasedDIDemo-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/DIDemo-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/CollectionDIDemo-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/AnnotationRequired-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/AnnotationDemo-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/HelloWorldConfigDemo-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/TextEditorConfigDemo-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/mvc1.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/HelloWeb-Project-Structure.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/HelloWeb-lib.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/HelloWeb-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/HelloWeb-Student-proj-structure.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/HelloWeb-Student-form.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/HelloWeb-Student-form-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/HelloWeb-Student-redirect-index.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/HelloWeb-Student-redirect-result.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/HelloWeb-Student-Exception-index.png">
<meta property="og:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/HelloWeb-Student-Exception-result.png">
<meta property="og:updated_time" content="2019-09-16T10:01:46.095Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Spring入门">
<meta name="twitter:description" content="久仰Spring MVC大名，现在公司要求学习Spring框架，打算借这个机会将Spring系列的东西学习一遍。接下来的学习任务:  Spring  Spring boot Mybatis  参考资料: [1] W3Cschool Spring 教程 本文CSDN地址: #Spring 学习#入门 这篇文章的项目代码地址：Spring-Demo">
<meta name="twitter:image" content="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/arch1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/blog/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://htmlgtmk.github.io/blog/2019/09/09/Spring入门/">





  <title>Spring入门 | GT Blog</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="English">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">GT Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/blog/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/blog/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://htmlgtmk.github.io/blog/blog/2019/09/09/Spring入门/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="GT">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/blog/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GT Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Spring入门</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-09T13:47:47+08:00">
                2019-09-09
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/blog/2019/09/09/Spring入门/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count valine-comment-count" data-xid="/blog/2019/09/09/Spring入门/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          
             <span id="/blog/2019/09/09/Spring入门/" class="leancloud_visitors" data-flag-title="Spring入门">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>久仰Spring MVC大名，现在公司要求学习Spring框架，打算借这个机会将Spring系列的东西学习一遍。接下来的学习任务:</p>
<ul>
<li>Spring </li>
<li>Spring boot</li>
<li>Mybatis</li>
</ul>
<p>参考资料:</p>
<p>[1] <a href="https://www.w3cschool.cn/wkspring/" target="_blank" rel="noopener">W3Cschool Spring 教程</a></p>
<p>本文CSDN地址: <a href="https://blog.csdn.net/HTMK_GT_MK/article/details/100892271" target="_blank" rel="noopener">#Spring 学习#入门</a></p>
<p>这篇文章的项目代码地址：<a href="https://github.com/HTMLgtMK/Spring-Demo.git" target="_blank" rel="noopener">Spring-Demo</a></p>
<a id="more"></a>

<h2 id="Spring-概述"><a href="#Spring-概述" class="headerlink" title="Spring 概述"></a>Spring 概述</h2><p> 2019-09-09 14:18</p>
<p><strong>概述</strong></p>
<p>Spring 由Rod Johnson编写，于2003 年 6 月在首次在 Apache 2.0 Licence下发布，是目前最受欢迎的企业级Java应用程序开发框架。Spring是一个开源的轻量级Java平台。</p>
<p>*<em>编程模型：<a href="https://en.wikipedia.org/wiki/Plain_old_Java_object" target="_blank" rel="noopener">POJO, Plain Old Java Object</a>. *</em></p>
<p><code>POJO</code>是一个简单的Java类，没有<code>extends</code>, <code>implements</code> or <code>@annotations</code> . 不需要遵守任何Java模型，约定或者框架的Java对象。在实际应用中，可能会有annotations存在。如下3种都不是POJO :</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Foo</span> <span class="keyword">extends</span> <span class="title">javax</span>.<span class="title">servlet</span>.<span class="title">http</span>.<span class="title">HttpServlet</span> </span>&#123; ... &#125;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Foo</span> <span class="keyword">implements</span> <span class="title">javax</span>.<span class="title">ejb</span>.<span class="title">EntityBean</span> </span>&#123; .. &#125;</span><br><span class="line"><span class="meta">@javax</span>.persistence.Entity <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Baz</span> </span>&#123; ... &#125;</span><br></pre></td></tr></table></figure>

<p><code>JavaBean</code>是一种可以被<code>serializable</code>，拥有一个<code>no-argument constructor</code>，并且允许用过<code>getter and setter or is</code> 来访问<code>properties</code>的 POJO . 下面是一个JavaBean的例子:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;h:input value=<span class="string">"#&#123;MyBean.someProperty&#125;"</span> /&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBean</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String someProperty;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getSomeProperty</span><span class="params">()</span> return someProperty</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSomeProperty</span><span class="params">(String someProperty)</span> <span class="keyword">this</span>.someProperty </span>= someProperty;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>面向切面的程序设计(AOP)</strong>: AOP( Aspect Oriented programming )是一种面向业务逻辑的编程方式，目的是为了减少模块间的耦合性。例如实现 persistent, transaction, security等。</p>
<p>面向对象模型(OOP)是面向对象的编程方式，目的是为了隔离实体，封装属性和操作， 例如 Employee, Student 。这两种方式的侧重点不同。</p>
<p><strong>控制反转(IoC) 与 依赖注入(DI)</strong>: <code>控制反转(Invension of Control, IoC)</code>, 是OOP种的一种设计原则，用来减低计算机代码之间的耦合度。最常见的方式为 <code>依赖注入(Dependency Injection, DI)</code>，和 <code>依赖查找(Dependency Lookup)</code>。详细参考<a href="https://zh.wikipedia.org/wiki/控制反转" target="_blank" rel="noopener">控制反转</a>.</p>
<h2 id="Spring-体系结构"><a href="#Spring-体系结构" class="headerlink" title="Spring 体系结构"></a>Spring 体系结构</h2><p>2019-09-09 15:23</p>
<p>Spring 的体系结构如下:</p>
<p><img src="/blog/2019/09/09/Spring入门/arch1.png" alt="Sprint体系结构"></p>
<p><strong>Core Container</strong></p>
<ul>
<li>spring-core : 提供了框架的基本组成部分，包括 IoC 和 注解功能。</li>
<li>spring-beans : 提供了 BeanFactory。</li>
<li>context: 以一种类似于JNDI注册的方式访问对象。ApplicationContext是Context模块的焦点。</li>
<li>spring-expression : 提供了强大的表达式语言，用于在运行时查询和操作对象。它是JSP2.1规范中定义的统一表达式语言的扩展。</li>
</ul>
<p><strong>Data Access/Integration</strong></p>
<ul>
<li>JDBC : Java 和 DB的连接控制。</li>
<li>ORM : 对象关系映射(Object Relation Mapping) 提供来对流行的对象关系映射API的集成，包括JPA, JDO和Hibernate。</li>
<li>OXM</li>
<li>JMS : 提供了 producer-consumer 的消息功能。</li>
<li>transaction </li>
</ul>
<p><strong>Web</strong></p>
<ul>
<li>Web ：提供了面向Web的基本功能和面向Web应用上下文， eg: multipart files upload, servlet , etc.</li>
<li>Web-MVC : 为Web应用提供来了模型视图控制(MVC)和 REST Web服务的实现。</li>
<li>Web-Socket : 为 WebSocket-based 提供了支持，在Web应用程序中提供来Server和Client之间通信的两种方式。</li>
<li>Web-Portlet : 提供来用于Portlet环境的MVC实现，并反映来spring-webmvc的功能。</li>
</ul>
<h2 id="Spring-环境配置"><a href="#Spring-环境配置" class="headerlink" title="Spring 环境配置"></a>Spring 环境配置</h2><p>2019-09-09 18:38</p>
<ol>
<li><p>安装jdk，配置环境变量; 安装IDE，如 eclipse 或者 IntelliJ IDEA。</p>
</li>
<li><p>安装 Apache Commons Logging API.</p>
<p>从 <a href="http://commons.apache.org/logging/" target="_blank" rel="noopener">http://commons.apache.org/logging/</a> 下载最新二进制版本，目前是<code>commons-logging-1.2-bin.tar.gz</code>，将其解压到<code>/usr/local/commons-logging-1.2</code>目录下。</p>
</li>
<li><p>安装 Spring 框架库</p>
<p>从 <a href="http://repo.spring.io/release/org/springframework/spring" target="_blank" rel="noopener">http://repo.spring.io/release/org/springframework/spring</a> 下载最新的Spring二进制框架文件，目前是  <a href="https://repo.spring.io/release/org/springframework/spring/5.1.9.RELEASE/spring-framework-5.1.9.RELEASE-dist.zip" target="_blank" rel="noopener">spring-framework-5.1.9.RELEASE-dist.zip</a>，将其解压到 <code>/usr/local/spring-framework-5.1.9.RELEASE</code>。</p>
</li>
</ol>
<p>如果使用的 IDE 是 eclipse ,  那么将这些类库添加到<code>build path</code>， <code>add external jar</code>，不需要将这些类库添加到 <code>CLASSPATH</code> 环境变量，否则需要。</p>
<p>另外，也可以使用 maven 配置 spring. Spring 在 Maven Central 的位置为: <a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a>. 由于 Spring 是高度模块化的，各个模块之间的耦合度很小甚至没有互相依赖。下面列出 Maven Central 中 Spring 的几个基本模块：</p>
<table>
<thead>
<tr>
<th>Group ID</th>
<th align="left">Artifact ID</th>
<th align="left">Latest Version</th>
<th align="left">Updated</th>
</tr>
</thead>
<tbody><tr>
<td></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-core" target="_blank" rel="noopener">spring-core</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-core/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-core&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-beans" target="_blank" rel="noopener">spring-beans</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-context" target="_blank" rel="noopener">spring-context</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-context-support" target="_blank" rel="noopener">spring-context-support</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-expression" target="_blank" rel="noopener">spring-expression</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-aop" target="_blank" rel="noopener">spring-aop</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-jdbc" target="_blank" rel="noopener">spring-jdbc</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-orm" target="_blank" rel="noopener">spring-orm</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-jms" target="_blank" rel="noopener">spring-jms</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-messaging" target="_blank" rel="noopener">spring-messaging</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-messaging/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(82)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-messaging&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-oxm" target="_blank" rel="noopener">spring-oxm</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-web" target="_blank" rel="noopener">spring-web</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-webmvc" target="_blank" rel="noopener">spring-webmvc</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-websocket" target="_blank" rel="noopener">spring-websocket</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-aspects" target="_blank" rel="noopener">spring-aspect</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-instrument" target="_blank" rel="noopener">spring-instrument</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
<tr>
<td><a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">org.springframework</a></td>
<td align="left"><a href="https://search.maven.org/search?q=a:spring-test" target="_blank" rel="noopener">spring-test</a></td>
<td align="left"><a href="https://search.maven.org/artifact/org.springframework/spring-beans/5.1.9.RELEASE/jar" target="_blank" rel="noopener">‎ 5.1.9.RELEASE</a>[(99+)](<a href="https://search.maven.org/search?q=g:org.springframework" target="_blank" rel="noopener">https://search.maven.org/search?q=g:org.springframework</a> AND a:spring-beans&amp;core=gav)</td>
<td align="left">02-Aug-2019</td>
</tr>
</tbody></table>
<p>Maven 配置方法：在 <code>pom.xml</code>文件中，添加依赖: </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">org.springframework.version</span>&gt;</span>5.1.9.RELEASE<span class="tag">&lt;/<span class="name">org.springframework.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;org.springframework.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span> <span class="comment">&lt;!-- 运行时范围，确保在任何特定于Spring的API上没有编译时依赖性 --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 继续添加其他 spring 模块依赖, 如 spring-beans 等 --&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Spring-Hello-World-实例"><a href="#Spring-Hello-World-实例" class="headerlink" title="Spring Hello World 实例"></a>Spring Hello World 实例</h2><p>2019-09-09 20:56</p>
<p>这部分开始实际的编程。</p>
<ol>
<li><p>创建Java项目：用 eclipse 创建Java项目。</p>
</li>
<li><p>添加必要的库：为HelloWorld项目添加必要spring依赖，如 spring-core, spring-beans, spring-context, 等。添加 common-logging 依赖。</p>
<p>添加完后的项目如下：</p>
<p><img src="/blog/2019/09/09/Spring入门/helloworld-project.png" alt="helloworld-project.png"></p>
</li>
<li><p>创建源文件：</p>
<ol>
<li><p>在 src 目录下创建 <strong>com.gthncz</strong> 包，创建 源文件<code>HelloWorld.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> String msg;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getMsg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> msg;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMsg</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.msg = msg;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在 com.gthncz  包下，创建 源文件 <code>MainApp.java</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">package com.gthncz;</span><br><span class="line"></span><br><span class="line">import org.springframework.context.ApplicationContext;</span><br><span class="line">import org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line">public class MainApp &#123;</span><br><span class="line">	</span><br><span class="line">	public static void main(String[]  args) &#123;</span><br><span class="line">		@SuppressWarnings(&quot;resource&quot;)</span><br><span class="line">		ApplicationContext context = new ClassPathXmlApplicationContext(&quot;Beans.xml&quot;);</span><br><span class="line">		HelloWorld helloWold = (HelloWorld) context.getBean(&quot;helloWorld&quot;);</span><br><span class="line">		String msg = helloWold.getMsg();</span><br><span class="line">		System.out.println(&quot;Get message : &quot; + msg);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>这里使用框架API <code>ClassPathXmlApplicationContext</code>来创建应用程序的上下文。这个API加载beans的配置文件并最终基于所提供的API，它处理创建并初始化所有的对象，即在配置中指定的<code>Beans.xml</code>文件的beans 。</p>
<p>第二步是使用<code>getBean(id)</code>方法获取所需的bean。</p>
</li>
<li><p>创建bean配置文件</p>
<p>该文件是一个XML文件，在<code>src</code>目录下创建：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       spring-beans.xsd"</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 出现错误: org.xml.sax.SAXParseException; lineNumber: 4; columnNumber: 57; cvc-elt.1: Cannot find the declaration of element 'beans'. </span></span><br><span class="line"><span class="comment">		原因: 命名空间错误。使用 spring-beans.xsd 创建的xml文件中的 xmlns 为 xmlns:p，改过来就好了，</span></span><br><span class="line"><span class="comment">		另外, 	xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd" 改过来</span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloWorld"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.HelloWorld"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"msg"</span> <span class="attr">value</span>=<span class="string">"Hello World!"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>我在创建 <code>Beans.xml</code>文件时使用 <code>create from XSD schema</code>，使用 <code>springframework-5.1.9.RELEASE/schema/beans</code>中的 <code>beans.xsd</code>文件。注意需要修改 <code>namespace</code>, <code>xsi:schemaLocation</code>。</p>
<p>通常开发人员保存该文件的名称为 <strong>Beans.xml</strong> 文件，当然你也可以设置成任何你喜欢的名称。但是你必须确保这个文件在 CLASSPATH 中是可用的，并在主应用程序中使用相同的名称，而在 MainApp.java 文件中创建应用程序的上下文。</p>
<p>Beans.xml 用于给不同的 bean 分配唯一的 ID，并且控制不同值的对象的创建，而不会影响 Spring 的任何源文件。例如，使用下面的文件，你可以为 “message” 变量传递任何值，因此你就可以输出信息的不同值，而不会影响的 HelloWorld.java和MainApp.java 文件。当 Spring 应用程序被加载到内存中时，框架利用了上面的配置文件来创建所有已经定义的 beans，并且按照标签的定义为它们分配一个唯一的 ID。你可以使用标签来传递在创建对象时使用不同变量的值。</p>
</li>
<li><p>运行程序</p>
<p>运行结果:</p>
<p><img src="/blog/2019/09/09/Spring入门/helloworld-result.png" alt="helloworld-result.png"></p>
</li>
</ol>
<p>到此，Hello World项目就结束了。 先回去睡了。。。</p>
<h2 id="Spring-IoC容器"><a href="#Spring-IoC容器" class="headerlink" title="Spring IoC容器"></a>Spring IoC容器</h2><p>2019-09-10 08:28</p>
<p>Spring容器是Spring框架的核心。容器将创建对象（称为 Spring Bean），配置对象，并管理（通过依赖注入， DI）他们的从创建到销毁的整个生命周期。</p>
<p><img src="/blog/2019/09/09/Spring入门/ioc1.jpg" alt="ioc1.jpg"></p>
<p>上图是Spring的工作视图，Spring IoC容器利用Java 的 POJO类和配置元数据(Metadata)来生成和配置应用程序。Metadata 可以通过XML, Java注释 以及 Java Code来表示，Metadata指明了哪些类需要实例化。</p>
<p><strong>IoC容器</strong>是具有依赖注入的容器。通常，我们使用<code>new</code>关键字新建Class Instance，控制权由程序员控制，而”控制反转”是指new实例工作不由程序员来完成，而是由Spring Container实现。</p>
<p>两种不同类型的Spring Container:</p>
<table>
<thead>
<tr>
<th align="center">序号</th>
<th align="center">容器 &amp; 描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">1</td>
<td align="center"><code>Spring BeanFactory</code>容器，是Spring中最简单的容器，给ID提供了最基本的支持。</td>
</tr>
<tr>
<td align="center">2</td>
<td align="center"><code>Spring ApplicationContainer</code>容器，该容器添加了更多的企业特性，比如从一个属性文件中解析文本信息的能力。</td>
</tr>
</tbody></table>
<p><code>ApplicationContainer</code>容器的功能包括<code>BeanFactory</code>的所有功能，一般情况下建议使用<code>ApplicationContainer</code>。当然，<code>BeanFactory</code>仍然可以用于轻量级的应用程序，如移动设备或者基于applet的应用程序。在这些情况下BeanFactory的数据量和速度比ApplicationContainer更加显著。</p>
<h3 id="Spring-BeanFactory-容器"><a href="#Spring-BeanFactory-容器" class="headerlink" title="Spring BeanFactory 容器"></a>Spring BeanFactory 容器</h3><p>2019-09-10 09:09</p>
<p>它是最简单的容器，提供DI支持，在<code>org.springframework.beans.factory.BeanFactory</code>中定义。</p>
<p>在Spring中，有大量对BeanFactory的实现，其中最常用的是<strong>XmlBeanFactory</strong>类。这个容器从XML文件中读取配置元数据，由这些元数据生成一个被配置化的系统或应用。</p>
<p>下面是一个使用 XmlBeanFactory的例子，其他文件使用前面的HelloWorld项目中的文件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.xml.XmlBeanFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.core.io.ClassPathResource;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"deprecation"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanFactoryDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		XmlBeanFactory factory = <span class="keyword">new</span> XmlBeanFactory(<span class="keyword">new</span> ClassPathResource(<span class="string">"Beans.xml"</span>));</span><br><span class="line">		HelloWorld helloWorld = (HelloWorld) factory.getBean(<span class="string">"helloWorld"</span>);</span><br><span class="line">		System.out.println(<span class="string">"Get Message: "</span> + helloWorld.getMsg());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行输出：</p>
<p><img src="/blog/2019/09/09/Spring入门/XmlBeanfactory-result.png" alt="XmlBeanfactory-result.png"></p>
<p>注意到，我目前的Spring版本是5.1.9.RELEASE，在使用 XmlBeanFactory 时提示 <code>deprecation</code> warnning。StackOverflow 上面也有相关问题，但是大家都推荐使用 <code>ClassPathXmlApplicationContext</code>了。。。</p>
<h3 id="ApplicationContext-容器"><a href="#ApplicationContext-容器" class="headerlink" title="ApplicationContext 容器"></a>ApplicationContext 容器</h3><p>2019-09-10 10:08</p>
<p>Application Context是BeanFactory的字接口，也被称为 <code>Spring 上下文</code>。</p>
<p>Application Context 具有 BeanFactory的全部功能，另外还增加了企业所需要的功能，比如从属性文件中解析文本信息和将事件传递给所指定的监听器。</p>
<p>最常用的 Application Context 接口实现如下，都是从XML文件中加载已被定义的bean：</p>
<ul>
<li><code>FileSystemXmlApplicationContext</code>：需要提供XML文件的完整路径。</li>
<li><code>ClassPathXmlApplicationContext</code>：从 CLASSPATH 路径下查找XML配置文件，不需要完整路径，但是需要正确配置 CLASSPATH 环境变量。</li>
<li><code>WebXmlApplicationContext</code> ：该容器在一个Web应用程序的范围内加载在Xml文件中已经被定义的bean。</li>
</ul>
<p>接下来是各个 Application Context的demo：</p>
<ol>
<li><p>FileSystemApplicationContext</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.FileSystemXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FileSystemApplicationContextDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">"resource"</span>)</span><br><span class="line">		ApplicationContext context = <span class="keyword">new</span> FileSystemXmlApplicationContext(<span class="string">"src/Beans.xml"</span>);</span><br><span class="line">		HelloWorld helloWorld = (HelloWorld) context.getBean(<span class="string">"helloWorld"</span>);</span><br><span class="line">		System.out.println(<span class="string">"Get Message: "</span> + helloWorld.getMsg());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;s</span><br></pre></td></tr></table></figure>

<p>执行输出：</p>
<p><img src="/blog/2019/09/09/Spring入门/FileSystemXmlApplicationContext-result.png" alt="FileSystemXmlApplicationContext-result.png"></p>
<p>需要注意的是，前面的Beans.xml文件中 xsi:schemaLocation 位置只写了一个相对路径，需要改成完整的路径。</p>
</li>
<li><p>ClassPathXmlApplicationContext</p>
<p>这个前面已经描述过了，这里不再赘述。</p>
</li>
<li><p>WebXmlApplicationContext</p>
<p>TODO 后续添加。</p>
</li>
</ol>
<h3 id="Spring-Bean-定义"><a href="#Spring-Bean-定义" class="headerlink" title="Spring Bean 定义"></a>Spring Bean 定义</h3><p>2019-09-10 11:20</p>
<p>Spring Bean是由容器用配置元数据创建的，例如，前面看到的XML中表单中的定义。</p>
<p>定义 bean 的属性：</p>
<table>
<thead>
<tr>
<th>属性</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>class</td>
<td>强制的，指定用来创建 bean 的 类（packageName + className, 完整路径）。</td>
</tr>
<tr>
<td>name</td>
<td>指定唯一的 bean 标识符，可以使用 id 或name 属性来指定。</td>
</tr>
<tr>
<td>scope</td>
<td>指定由创建的对象的作用域。</td>
</tr>
<tr>
<td>constructor-arg</td>
<td>用来注入依赖关系， TODO</td>
</tr>
<tr>
<td>properties</td>
<td>用来注入依赖关系， TODO</td>
</tr>
<tr>
<td>autowiring mode</td>
<td>用来注入依赖关系， TODO</td>
</tr>
<tr>
<td>lazy-initialization mode</td>
<td>延迟初始化的 bean 告诉 IoC 容器在它第一次被请求时创建实例，而不是在启动时创建实例。</td>
</tr>
<tr>
<td>initialization 方法</td>
<td>在 bean 的所有必需的属性被容器设置之后，调用的回调方法。</td>
</tr>
<tr>
<td>destruction 方法</td>
<td>当包含该 bean 的容器被销毁时，调用的回调方法。</td>
</tr>
</tbody></table>
<p><strong>Bean 与 Spring 容器的关系</strong></p>
<p><img src="/blog/2019/09/09/Spring入门/bean-spring-relation.jpg" alt="bean-spring-relation.jpg"></p>
<p><strong>Spring 配置元数据</strong></p>
<p>Spring IoC 容器完全由实际编写的配置元数据的格式解藕。有3种配置元数据的方法：</p>
<ul>
<li>基于 XML 的配置文件</li>
<li>基于 annotation 的配置</li>
<li>基于 Java 的配置</li>
</ul>
<p>对于基于 XML 的配置，Spring 2.0 以后使用 Schema 的格式，使得不同类型的配置拥有了自己的命名空间，使得配置文件更具有扩展性。下面是一个更加完整的 XML 格式配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- A simple bean definition --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">""</span> &gt;</span></span><br><span class="line">    	<span class="comment">&lt;!-- collaborators and configuration for this bean go here --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- A bean definition with lazy init set on --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">""</span> <span class="attr">lazy-init</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    	<span class="comment">&lt;!-- collaborators and configuration for this bean go here --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- A bean definition with initialization method --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">""</span> <span class="attr">init-method</span>=<span class="string">"..."</span> &gt;</span></span><br><span class="line">    	<span class="comment">&lt;!-- collaborators and configuration for this bean go here --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- A bean definition with destruction method --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">""</span> <span class="attr">class</span>=<span class="string">""</span> <span class="attr">destroy-method</span>=<span class="string">"..."</span> &gt;</span></span><br><span class="line">    	<span class="comment">&lt;!-- collaborators and configuration for this bean go here --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- more bean definitions go here --&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在上述示例中：</p>
<ol>
<li>xmlns=”<a href="http://www.springframework.org/schema/beans&quot;" target="_blank" rel="noopener">http://www.springframework.org/schema/beans&quot;</a> 默认命名空间：它没有空间名，用于Spring Bean 的定义;</li>
<li>xmlns:xsi=”<a href="http://www.w3.org/2001/XMLSchema-instance&quot;" target="_blank" rel="noopener">http://www.w3.org/2001/XMLSchema-instance&quot;</a>, xsi 命名空间：这个命名空间用于为每个文档中命名空间指定相应的 Schema 样式文件，是标准组织定义的标准命名空间。</li>
</ol>
<p>*<em>Spring Bean Scope *</em>(作用域)</p>
<p>当在 Spring 中定义一个 Bean 时， 必需声明这个 Bean 的 scope。Spring 框架支持5种作用域，如下：</p>
<table>
<thead>
<tr>
<th align="center">scope</th>
<th align="center">description</th>
</tr>
</thead>
<tbody><tr>
<td align="center">singleton</td>
<td align="center">单例模式，Spring  IoC 容器中只存在一个 Bean 实例; *<em>默认值 *</em></td>
</tr>
<tr>
<td align="center">prototype</td>
<td align="center">每次从容器中调用 Bean 时，都创建一个新的 Bean 实例，即每次调用 getBean() 时，相当于调用  newXXXBean()</td>
</tr>
<tr>
<td align="center">request</td>
<td align="center">每次 HTTP 请求都会创建一个 Bean 实例，该 scope 仅作用于WebApplicationContext 环境</td>
</tr>
<tr>
<td align="center">session</td>
<td align="center">同一个 HTTP Session 共用一个 Bean 实例，不同 Session 使用不同 Bean 实例，该 scope 仅作用于 WebApplicationContext 环境</td>
</tr>
<tr>
<td align="center">global-session</td>
<td align="center">一般用于Portlet应用环境，该运用域仅适用于WebApplicationContext环境</td>
</tr>
</tbody></table>
<p>以下是测试 <code>singleton</code> 和 <code>prototype</code> scope 的例子，其它 scope 在后面添加。</p>
<ul>
<li>Beans_scope.xml 文件</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"singletonBean"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.HelloWorld"</span> <span class="attr">scope</span>=<span class="string">"singleton"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"msg"</span> <span class="attr">value</span>=<span class="string">"Hello world !"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"prototypeBean"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.HelloWorld"</span> <span class="attr">scope</span>=<span class="string">"prototype"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"msg"</span> <span class="attr">value</span>=<span class="string">"Hello world !"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"requestBean"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.HelloWorld"</span> <span class="attr">scope</span>=<span class="string">"request"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"msg"</span> <span class="attr">value</span>=<span class="string">"Hello world !"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sessionBean"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.HelloWorld"</span> <span class="attr">scope</span>=<span class="string">"session"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"msg"</span> <span class="attr">value</span>=<span class="string">"Hello world !"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"globalSessionBean"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.HelloWorld"</span> <span class="attr">scope</span>=<span class="string">"global-session"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"msg"</span> <span class="attr">value</span>=<span class="string">"Hello world !"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里继续使用 HelloWorld 类，创建5个不同 scope 的 Bean。</p>
<ul>
<li>ScopeDemo.java文件</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScopeDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">"resource"</span>)</span><br><span class="line">		ApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"Beans_scope.xml"</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * test singleton scope</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		HelloWorld singletonBean1 = (HelloWorld) context.getBean(<span class="string">"singletonBean"</span>);</span><br><span class="line">		HelloWorld singletonBean2 = (HelloWorld) context.getBean(<span class="string">"singletonBean"</span>);</span><br><span class="line">		<span class="comment">// 比较两个对象的地址</span></span><br><span class="line">		System.out.println(<span class="string">"Singleton Bean is equal ?  "</span> + (singletonBean1 == singletonBean2));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">/**</span></span><br><span class="line"><span class="comment">		 * test prototype scope</span></span><br><span class="line"><span class="comment">		 */</span></span><br><span class="line">		HelloWorld prototypeBean1 = (HelloWorld) context.getBean(<span class="string">"prototypeBean"</span>);</span><br><span class="line">		HelloWorld prototypeBean2 = (HelloWorld) context.getBean(<span class="string">"prototypeBean"</span>);</span><br><span class="line">		System.out.println(<span class="string">"Prototype Bean is equal ?  "</span> + (prototypeBean1 == prototypeBean2));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// more information about bean scope</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行输出：</p>
<p><img src="/blog/2019/09/09/Spring入门/scopedemo-result.png" alt="scopedemo-result.png"></p>
<p>由结果可以看出，singleton scope 获取得到的 Bean 是单例模式，而 prototype scope 获取得到新实例。</p>
<p><strong>Spring Bean 生命周期</strong></p>
<p>Bean 的生命周期: Bean 的定义 -&gt; Bean 的初始化 -&gt; Bean 的使用 -&gt; Bean 的销毁</p>
<p>在 Bean 的生命周期中的 初始化 和 销毁 阶段，存在方法回调，允许用户处理一些自己的逻辑。有两种不同的方式实现回调：Java 接口回调 ， XML 方法声明。</p>
<ol>
<li><p>Java 接口回调</p>
<p><code>org.springframework.beans.factory.InitializingBean</code> 定义了 初始化回调。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>;</span><br></pre></td></tr></table></figure>

<p><code>org.springframework.beans.factory.DisposableBean</code> 定义来 销毁回调。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> destroy <span class="keyword">throws</span> Exception;</span><br></pre></td></tr></table></figure>
</li>
<li><p>XML 方法声明</p>
<p>在 XML 配置文件中可以声明 <code>init-method</code> 属性和 <code>destroy-method</code> 属性。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"lifeCircleBean"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.LifeCircleBean"</span> </span></span><br><span class="line"><span class="tag">      <span class="attr">init-method</span>=<span class="string">"xml_initialize"</span> <span class="attr">destroy-method</span>=<span class="string">"xml_destroy"</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"msg"</span> <span class="attr">value</span>=<span class="string">"value on xml"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ol>
<p>下面是 Spring Bean 生命周期回调方法的测试：</p>
<ul>
<li>Beans_lifecircle.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>  &gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"lifeCircleBean"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.LifeCircleBean"</span> </span></span><br><span class="line"><span class="tag">		<span class="attr">init-method</span>=<span class="string">"xml_initialize"</span> <span class="attr">destroy-method</span>=<span class="string">"xml_destroy"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"msg"</span> <span class="attr">value</span>=<span class="string">"value on xml"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>XML 配置文件中指定了 init-method 和 destroy-method。</p>
<ul>
<li>LifeCircleBean.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.DisposableBean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.InitializingBean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LifeCircleBean</span> <span class="keyword">implements</span> <span class="title">InitializingBean</span>, <span class="title">DisposableBean</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> String msg;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getMsg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> msg;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMsg</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.msg = msg;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * implement of InitializingBean</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterPropertiesSet</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" run on afterPropertiesSet ... "</span>);</span><br><span class="line">		System.out.println(<span class="string">"Msg on afterPropertiesSet: "</span> + <span class="keyword">this</span>.msg);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * implement of DisposableBean</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" run on destroy ... "</span>);</span><br><span class="line">		System.out.println(<span class="string">"Msg on destroy: "</span> + <span class="keyword">this</span>.msg);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * implement of init-method which definite in xml</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">xml_initialize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" run on xml_initialize ... "</span>);</span><br><span class="line">		System.out.println(<span class="string">"Msg on xml_initialize: "</span> + <span class="keyword">this</span>.msg);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * implement of destroy-method which definite in xml</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">xml_destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" run on xml_destroy ... "</span>);</span><br><span class="line">		System.out.println(<span class="string">"Msg on xml_destroy: "</span> + <span class="keyword">this</span>.msg);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Bean 中实现了 Java 接口回调 和 XML 指定的回调方法。</p>
<ul>
<li>BeanLifeCircleDemo.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.AbstractApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanLifeCircleDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">"resource"</span>)</span><br><span class="line">		AbstractApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"Beans_lifecircle.xml"</span>);</span><br><span class="line">		LifeCircleBean lifeCircleBean = (LifeCircleBean) context.getBean(<span class="string">"lifeCircleBean"</span>);</span><br><span class="line">		System.out.println(<span class="string">"Msg on main: "</span> + lifeCircleBean.getMsg());</span><br><span class="line">		<span class="comment">// 需要注册一个在 AbstractApplicationContext 类中声明的关闭 hook 的 registerShutdownHook() 方法。它将确保正常关闭，并且调用相关的 destroy 方法。</span></span><br><span class="line">		context.registerShutdownHook(); <span class="comment">// 要使用 AbstractApplicationContext</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这里，你需要注册一个在 AbstractApplicationContext 类中声明的关闭 hook 的 <strong>registerShutdownHook()</strong>  方法。它将确保正常关闭，并且调用相关的 destroy 方法。仅仅使用 ApplicationContext 接口类的话是没有这个方法的。</p>
<p>执行输出：</p>
<p><img src="/blog/2019/09/09/Spring入门/BeanLifeCircleDemo-result.png" alt="BeanLifeCircleDemo-result.png"></p>
<p>从输出的结果可以看出，Java 接口回调 运行在 XML 声明的方法前。当然，实际项目中，只需要实现一种回调就可以，并且建议使用 XML 声明的方法，因为这种方法更加灵活。</p>
<ol start="3">
<li>默认的初始化和销毁方法</li>
</ol>
<p>如果你有太多具有相同名称的初始化或者销毁方法的 Bean，那么你不需要在每一个 bean 上声明初始化方法和销毁方法。框架使用元素中的 <code>default-init-method</code> 和 <code>default-destroy-method</code> 属性提供了灵活地配置这种情况，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">default-init-method</span>=<span class="string">"init"</span> </span></span><br><span class="line"><span class="tag">    <span class="attr">default-destroy-method</span>=<span class="string">"destroy"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"..."</span> <span class="attr">class</span>=<span class="string">"..."</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- collaborators and configuration for this bean go here --&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Spring-Bean-PostProcessor-后置处理器"><a href="#Spring-Bean-PostProcessor-后置处理器" class="headerlink" title="Spring Bean PostProcessor 后置处理器"></a>Spring Bean PostProcessor 后置处理器</h3><p>2019-09-10 18:52</p>
<p><code>Bean PostProcessor</code> 允许在调用 <strong>初始化</strong> 方法<strong>前后</strong>对 Bean 进行额外的处理。<code>org.springframework.beans.factory.config.BeanPostProcessor</code> 接口定义了2个方法，在这里可以实现自己的实例化逻辑，依赖解析逻辑等。</p>
<p>可以在Spring容器中插入一个或多个 PostProcessor ，通过设置 BeanPostProcessor 实现的 <code>Ordered</code> 接口提供的 <code>order</code> 属性来控制这些 BeanPostProcessor 接口的执行顺序。    </p>
<p><code>ApplicationContext</code> 会自动检测由 <code>BeanPostProcessor</code>接口实现的 Bean ，注册这些 bean 为 PostProcessor，然后通过在容器中创建 bean，在适当的时候调用它。</p>
<p>下面是一个 PostProcessor 的例子：</p>
<ul>
<li>Beans_post_processor.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloWorld"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.HelloWorld"</span> </span></span><br><span class="line"><span class="tag">		<span class="attr">init-method</span>=<span class="string">"initialize"</span> <span class="attr">destroy-method</span>=<span class="string">"destroy"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"msg"</span> <span class="attr">value</span>=<span class="string">"Hello world !"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- ApplicationContext 会自动检测由 BeanPostProcessor 接口的实现定义的 bean，注册这些 bean 为后置处理器，然后通过在容器中创建 bean，在适当的时候调用它。 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.PostProcessorBean"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>在这个文件中指定了一个 PostProcessor，具体实现如下。</p>
<ul>
<li>PostProcessorBean.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz.beans;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.BeansException;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.config.BeanPostProcessor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PostProcessorBean</span> <span class="keyword">implements</span> <span class="title">BeanPostProcessor</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">postProcessBeforeInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" run on postProcessBeforeInitialization : "</span> + beanName);</span><br><span class="line">		<span class="keyword">return</span> BeanPostProcessor.<span class="keyword">super</span>.postProcessBeforeInitialization(bean, beanName);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> Object <span class="title">postProcessAfterInitialization</span><span class="params">(Object bean, String beanName)</span> <span class="keyword">throws</span> BeansException </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" run on postProcessAfterInitialization : "</span> + beanName);</span><br><span class="line">		<span class="keyword">return</span> BeanPostProcessor.<span class="keyword">super</span>.postProcessAfterInitialization(bean, beanName);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里实现了一个简单的 PostProcessor，只用于打印信息。</p>
<ul>
<li>BeanPostProcessorDemo.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.AbstractApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.HelloWorld;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanPostProcessorDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">"resource"</span>)</span><br><span class="line">		AbstractApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"Beans_post_processor.xml"</span>);</span><br><span class="line">		HelloWorld helloWorld = (HelloWorld) context.getBean(<span class="string">"helloWorld"</span>);</span><br><span class="line">		System.out.println(<span class="string">"Msg on main : "</span> + helloWorld.getMsg());</span><br><span class="line">		context.registerShutdownHook();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 main 中不需要对 PostProcessor 作声明什么的，好像从没出现过一样。。。</p>
<p>执行输出：</p>
<p><img src="/blog/2019/09/09/Spring入门/BeanPostProcessor-result.png" alt="BeanPostProcessor-result.png"></p>
<p>从输出中看出，<code>postProcessBeforeInitialization</code>在 Bean initialize 前调用，<code>postProcessAfterInitialization</code>在 Bean initialize 后调用。</p>
<h3 id="Spring-Bean-定义继承"><a href="#Spring-Bean-定义继承" class="headerlink" title="Spring Bean 定义继承"></a>Spring Bean 定义继承</h3><p>2019-09-10 19:17</p>
<p>Spring Bean 定义的继承与 Java 类的继承无关，但是继承的概念是一样的。子 bean 的定义继承父定义的<strong>配置数据</strong>（仅仅是配置数据）。子定义可以根据需要重写一些值，或者添加其他值。但是子类赋值父类也有的属性并不能修改父类上属性的值。</p>
<p>当你使用基于 XML 的配置元数据时，通过使用父属性 <code>parent=&quot;parent-id&quot;</code>，指定父 bean 作为该属性的值来表明子 bean 的定义。</p>
<p>下面是一个 Bean 继承的简单例子：</p>
<ul>
<li>Beans_extends.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans.xsd"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">default-init-method</span>=<span class="string">"initialize"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">default-destroy-method</span>=<span class="string">"destroy"</span></span></span><br><span class="line"><span class="tag">       &gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloWorld"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.HelloWorld"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"msg"</span> <span class="attr">value</span>=<span class="string">"Hello World!"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloChina"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.HelloChina"</span> <span class="attr">parent</span>=<span class="string">"helloWorld"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"msg2"</span> <span class="attr">value</span>=<span class="string">"Hello China!"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这里的 HelloChina Bean 指定了 HelloWorld 作为它的 parent，因此继承了 HelloWorld 拥有的属性值。</p>
<ul>
<li>HelloChina.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz.beans;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloChina</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = HelloChina.class.getSimpleName();</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String msg;  <span class="comment">// 值得注意的是，这里的 msg 在 parent 上是 private 类型的，但仍然可以继承到值</span></span><br><span class="line">	<span class="keyword">private</span> String msg2;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getMsg</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> msg;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMsg</span><span class="params">(String msg)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.msg = msg;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getMsg2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> msg2;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMsg2</span><span class="params">(String msg2)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.msg2 = msg2;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(TAG + <span class="string">" run on initialize ... "</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(TAG + <span class="string">" run on destroy ... "</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里 HelloChina 类具有 HelloWorld 的属性 msg，并且拥有自己的属性 msg2。</p>
<ul>
<li>BeanExtendsDemo.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.AbstractApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.HelloChina;</span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.HelloWorld;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanExtendsDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">"resource"</span>)</span><br><span class="line">		AbstractApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"Beans_extends.xml"</span>);</span><br><span class="line">		HelloWorld helloWorld = (HelloWorld) context.getBean(<span class="string">"helloWorld"</span>);</span><br><span class="line">		System.out.println(<span class="string">" helloWorld' Msg : "</span> + helloWorld.getMsg());</span><br><span class="line">		HelloChina helloChina = (HelloChina) context.getBean(<span class="string">"helloChina"</span>);</span><br><span class="line">		System.out.println(<span class="string">" helloChina' Msg : "</span> + helloChina.getMsg());</span><br><span class="line">		System.out.println(<span class="string">" helloChina' Msg2 : "</span> + helloChina.getMsg2());</span><br><span class="line">		</span><br><span class="line">		helloChina.setMsg(<span class="string">"Hello GT!"</span>);</span><br><span class="line">		System.out.println(<span class="string">" helloWorld' Msg : "</span> + helloWorld.getMsg());  <span class="comment">// 子类的属性赋值并没有改变父类上属性的值</span></span><br><span class="line">		System.out.println(<span class="string">" helloChina' Msg : "</span> + helloChina.getMsg());  </span><br><span class="line">		</span><br><span class="line">		context.registerShutdownHook();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行输出：</p>
<p><img src="/blog/2019/09/09/Spring入门/BeanExtendsDemo-result.png" alt="BeanExtendsDemo-result.png"></p>
<p>从输出上看，父类 HelloWorld 在子类 HelloChina 之前初始化，在其之后销毁。并且，HelloChina 并没有在 XML 配置 msg 的属性值，但是从父类 HelloWorld 中继承得到了属性值，输出结果为”Hello World”。</p>
<p><strong>Bean 定义模板</strong></p>
<p>你可以创建一个 Bean 定义模板，不需要花太多功夫它就可以被其他子 bean 定义使用。在定义一个 Bean 定义模板时，你不应该指定<strong>类</strong>的属性，而应该指定带 <strong>true</strong> 值的<strong>抽象</strong>属性，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"beanTeamplate"</span> <span class="attr">abstract</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"message1"</span> <span class="attr">value</span>=<span class="string">"Hello World!"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"message2"</span> <span class="attr">value</span>=<span class="string">"Hello Second World!"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"message3"</span> <span class="attr">value</span>=<span class="string">"Namaste India!"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"helloIndia"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.HelloIndia"</span> <span class="attr">parent</span>=<span class="string">"beanTeamplate"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"message1"</span> <span class="attr">value</span>=<span class="string">"Hello India!"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"message3"</span> <span class="attr">value</span>=<span class="string">"Namaste India!"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>父 bean 自身不能被实例化，因为它是不完整的，而且它也被明确地标记为抽象的(<code>abstract</code>)。当一个定义是抽象的，它仅仅作为一个纯粹的模板 bean 定义来使用的，充当子定义的父定义使用。</p>
<h2 id="Spring-依赖注入-DI"><a href="#Spring-依赖注入-DI" class="headerlink" title="Spring 依赖注入 DI"></a>Spring 依赖注入 DI</h2><p>2019-09-10 20:38</p>
<p>Spring框架的核心功能之一就是通过依赖注入的方式来管理Bean之间的依赖关系。</p>
<p><strong>依赖注入 DI</strong></p>
<p>当编写一个复杂的 Java 应用程序时，应用程序类应该尽可能独立于其他 Java 类来增加这些类重用的可能性，并且在做单元测试时，测试独立于其他类的独立性。依赖注入（或有时称为布线）有助于把这些类粘合在一起，同时保持他们独立。</p>
<p>假设你有一个包含文本编辑器组件的应用程序，并且你想要提供拼写检查。标准代码看起来是这样的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TextEditor</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> SpellChecker spellChecker;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TextEditor</span><span class="params">()</span></span>&#123;</span><br><span class="line">        spellChecker = <span class="keyword">new</span> SpellChecker();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在这里我们所做的的就是创建一个 TextEditor 和 SpellChecker 之间的依赖关系。在控制反转的场景中，我们反而会做这样的事情：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TextEditor</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> SpellChecker spellChecker;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">TextEditor</span><span class="params">(SpellChecker spellChecker)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.spellChecker = spellChecker;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里，TextEditor 不应该担心 SpellChecker 的实现。SpellChecker 将会独立实现，并且在 TextEditor 实例化的时候将提供给 TextEditor，整个过程是由 Spring 框架的控制。。因此，控制流通过依赖注入（DI）已经“反转”，因为你已经有效地委托依赖关系到一些外部系统。</p>
<p>依赖注入的第二种方法是通过 TextEditor 类的<code>Setter</code>方法，我们将创建 SpellChecker 实例，该实例将被用于调用 setter 方法来初始化 TextEditor 的属性。</p>
<p>下面是2种依赖注入DI的方法：</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>Constructor-based DI</code></td>
<td>当容器调用带有多个 args 的 constructor 的 Class 时，实现基于构造函数的 DI，每个代表在其他类中的一个依赖关系。</td>
</tr>
<tr>
<td><code>Setter-based DI</code></td>
<td>基于 setter 方法的 DI 是通过在调用无参数的构造函数或无参数的静态工厂方法实例化 bean 之后容器调用 beans 的 <code>setter</code> 方法来实现的。</td>
</tr>
</tbody></table>
<p>可以混合这两种方法，基于构造函数和基于 setter 方法的 DI，然而，有强制性依存关系时使用基于构造函数的DI ，有可选依赖关系时使用基于 setter 的DI 是一个好的做法。</p>
<h3 id="Spring-Constructor-based-DI"><a href="#Spring-Constructor-based-DI" class="headerlink" title="Spring Constructor-based DI"></a>Spring Constructor-based DI</h3><p>2019-09-10 21:11</p>
<p>当容器调用带有一组参数的类构造函数时，基于构造函数的 DI 就完成了，其中每个参数代表一个对其他类的依赖。</p>
<p>简单的例子：</p>
<ul>
<li>Beans_DI.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- Definition for TextEditor bean --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"textEditor"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.TextEditor"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">"spellChecker"</span> &gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- Definition for SpellChecker bean --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"spellChecker"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.SpellChecker"</span> &gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>用 <code>constructor-arg</code> 指定构造函数的参数。这里 有个问题，如果多个参数呢？</p>
<ul>
<li>SpellChecker.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz.beans;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpellChecker</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">SpellChecker</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Inside SpellChecker constructor. "</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">checkSpelling</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Inside checkSpelling. "</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>TextEditor.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz.beans;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TextEditor</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> SpellChecker spellChecker;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">TextEditor</span><span class="params">(SpellChecker spellChecker)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Inside TextEditor constructor. "</span>);</span><br><span class="line">		<span class="keyword">this</span>.spellChecker = spellChecker;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">spellCheck</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		spellChecker.checkSpelling();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过构造函数的参数传递依赖。</p>
<ul>
<li>ConstructorBasedDIDemo.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.AbstractApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.TextEditor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConstructorBasedDIDemo</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">"resource"</span>)</span><br><span class="line">		AbstractApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"Beans_DI.xml"</span>);</span><br><span class="line">		TextEditor textEditor = (TextEditor) context.getBean(<span class="string">"textEditor"</span>);</span><br><span class="line">		textEditor.spellCheck();</span><br><span class="line">		context.registerShutdownHook();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行输出：</p>
<p><img src="/blog/2019/09/09/Spring入门/ConstrcutorBasedDIDemo-result.png" alt="ConstrcutorBasedDIDemo-result.png"></p>
<p>从输出看，依赖项 SpellChecker 在 TextEditor 之前构造。</p>
<p><strong>构造函数参数解析</strong></p>
<p>如果存在不止一个参数时，当把参数传递给构造函数时，可能会存在歧义。要解决这个问题，那么构造函数的参数在 bean 定义中的顺序就是把这些参数提供给适当的构造函数的顺序就可以了。考虑下面的类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> x.y;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Foo</span><span class="params">(Bar bar, Baz baz)</span> </span>&#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"foo"</span> <span class="attr">class</span>=<span class="string">"x.y.Foo"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">"bar"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">"baz"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"bar"</span> <span class="attr">class</span>=<span class="string">"x.y.Bar"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"baz"</span> <span class="attr">class</span>=<span class="string">"x.y.Baz"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果是内置类型：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> x.y;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">Foo</span><span class="params">(<span class="keyword">int</span> year, String name)</span> </span>&#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"exampleBean"</span> <span class="attr">class</span>=<span class="string">"examples.ExampleBean"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">"int"</span> <span class="attr">value</span>=<span class="string">"2001"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">type</span>=<span class="string">"java.lang.String"</span> <span class="attr">value</span>=<span class="string">"Zara"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>使用 type 属性显式的指定了构造函数参数的类型，容器也可以使用与简单类型匹配的类型。</p>
<p>最后并且也是<strong>最好的传递</strong>构造函数参数的方式，使用 <code>index</code> 属性来显式的指定构造函数参数的索引。下面是基于索引为 0 的例子，如下所示：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"exampleBean"</span> <span class="attr">class</span>=<span class="string">"examples.ExampleBean"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"0"</span> <span class="attr">value</span>=<span class="string">"2001"</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">index</span>=<span class="string">"1"</span> <span class="attr">value</span>=<span class="string">"Zara"</span>/&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>最后，如果你想要向一个对象传递一个引用，你需要使用标签的 <code>ref</code> 属性，如果你想要直接传递值，那么你应该使用如上所示的 <code>value</code> 属性。</p>
<h3 id="Spring-Setter-based-DI"><a href="#Spring-Setter-based-DI" class="headerlink" title="Spring Setter-based DI"></a>Spring Setter-based DI</h3><p>2019-09-11</p>
<p>当容器调用一个无参的构造函数或一个无参的静态 factory 方法来初始化你的 bean 后，通过容器在你的 bean 上调用设值函数，基于设值函数的 DI 就完成了。</p>
<p>使用简单的设值函数来完成注入：</p>
<ul>
<li>Beans_DI.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">       http://www.springframework.org/schema/beans/spring-beans.xsd"</span> </span></span><br><span class="line"><span class="tag">       <span class="attr">default-init-method</span>=<span class="string">"initialize"</span></span></span><br><span class="line"><span class="tag">       <span class="attr">default-destroy-method</span>=<span class="string">"destroy"</span></span></span><br><span class="line"><span class="tag">       &gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- Definition for TextEditor bean --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"textEditor"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.TextEditor"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">"spellChecker"</span> &gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span> <span class="comment">&lt;!-- Constrcutor-based DI --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"autoComplement"</span> <span class="attr">ref</span>=<span class="string">"autoComplement"</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span> <span class="comment">&lt;!-- Setter-based DI --&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- Definition for SpellChecker bean --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"spellChecker"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.SpellChecker"</span> &gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- Definition for Autocomplement bean --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"autoComplement"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.AutoComplement"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>给 TextEdittor 添加了一个新的 属性 autoComplement, 通过在 XML 中配置属性完成注入，注意 autoComplement 是一个 对象引用，因此使用 <code>ref</code> 属性。</p>
<ul>
<li>AutoComplement.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz.beans;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AutoComplement</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">AutoComplement</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Inside AutoComplement constructor. "</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">complete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Inside complete . "</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Inside AutoComplement initialize . "</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Inside AutoComplement destroy . "</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>TextEditor.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz.beans;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TextEditor</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> SpellChecker spellChecker;</span><br><span class="line">	<span class="keyword">private</span> AutoComplement autoComplement;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">TextEditor</span><span class="params">(SpellChecker spellChecker)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Inside TextEditor constructor. "</span>);</span><br><span class="line">		<span class="keyword">this</span>.spellChecker = spellChecker;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">spellCheck</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		spellChecker.checkSpelling();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">autoComplete</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		autoComplement.complete();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> AutoComplement <span class="title">getAutoComplement</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Inside TextEditor getAutoComplement. "</span>);</span><br><span class="line">		<span class="keyword">return</span> autoComplement;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// a setter method to inject the dependency.</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAutoComplement</span><span class="params">(AutoComplement autoComplement)</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Inside TextEditor setAutoComplement. "</span>);</span><br><span class="line">		<span class="keyword">this</span>.autoComplement = autoComplement;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initialize</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Inside TextEditor initialize . "</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Inside TextEditor destroy . "</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>通过 <code>Setter</code> 方法将属性值注入到属性 autoComplement 中。</p>
<ul>
<li>DIDemo.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.AbstractApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.TextEditor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DIDemo</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">"resource"</span>)</span><br><span class="line">		AbstractApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"Beans_DI.xml"</span>);</span><br><span class="line">		TextEditor textEditor = (TextEditor) context.getBean(<span class="string">"textEditor"</span>);</span><br><span class="line">		textEditor.autoComplete();</span><br><span class="line">		textEditor.spellCheck();</span><br><span class="line">		context.registerShutdownHook();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里基本上没有变化。</p>
<p>执行输出：</p>
<p><img src="/blog/2019/09/09/Spring入门/DIDemo-result.png" alt="DIDemo-result.png"></p>
<p>从输出可以看出，AutoComplement 被注入到 TextEditor 中。并且，Constructor-based DI 依赖项 SpellCheker 在 TextEditor 之前创建和初始化，而 Setter-based DI 依赖项 AutoComplement 在 TextEditor 创建之后 创建和初始化， 在运行前 TextEditor 才完成 initialize 。</p>
<h3 id="Spring-注入内部-Beans"><a href="#Spring-注入内部-Beans" class="headerlink" title="Spring  注入内部 Beans"></a>Spring  注入内部 Beans</h3><p>2019-09-11 09:00</p>
<p><code>inner beans</code> 是在其他 bean 的范围内定义的 bean。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"outerBean"</span> <span class="attr">class</span>=<span class="string">"..."</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"target"</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"innerBean"</span> <span class="attr">class</span>=<span class="string">"..."</span>/&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="Spring-注入集合"><a href="#Spring-注入集合" class="headerlink" title="Spring 注入集合"></a>Spring 注入集合</h3><p>2019-09-11 09:01</p>
<p>Spring 提供了4种类型的集合配置元素，可以用于传递 java.util 中的 <code>List</code>, <code>Set</code>, <code>Map</code>, <code>Properties</code>，如下所示：</p>
<table>
<thead>
<tr>
<th>元素</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>&lt;list&gt;</code></td>
<td>它有助于连线，如注入一列值，允许重复。</td>
</tr>
<tr>
<td><code>&lt;set&gt;</code></td>
<td>它有助于连线一组值，但不能重复。</td>
</tr>
<tr>
<td><code>&lt;map&gt;</code></td>
<td>它可以用来注入 key-value pair的集合，其中名称和值可以是任何类型。</td>
</tr>
<tr>
<td><code>&lt;props&gt;</code></td>
<td>它可以用来注入 key-value pair的集合，其中名称和值都是字符串类型。</td>
</tr>
</tbody></table>
<p>一个简单的例子如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz.beans;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JavaCollection</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> List&lt;String&gt; list;</span><br><span class="line">	<span class="keyword">private</span> Set&lt;String&gt; set;</span><br><span class="line">	<span class="keyword">private</span> Map&lt;String, String&gt; map;</span><br><span class="line">	<span class="keyword">private</span> Properties properties;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">getList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" List elements : "</span> + <span class="keyword">this</span>.list);</span><br><span class="line">		<span class="keyword">return</span> list;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setList</span><span class="params">(List&lt;String&gt; list)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.list = list;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Set&lt;String&gt; <span class="title">getSet</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Set elements : "</span> + <span class="keyword">this</span>.set);</span><br><span class="line">		<span class="keyword">return</span> set;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSet</span><span class="params">(Set&lt;String&gt; set)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.set = set;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Map&lt;String, String&gt; <span class="title">getMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Map elements : "</span> + <span class="keyword">this</span>.map);</span><br><span class="line">		<span class="keyword">return</span> map;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMap</span><span class="params">(Map&lt;String, String&gt; map)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.map = map;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Properties <span class="title">getProperties</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Properties elements : "</span> + <span class="keyword">this</span>.properties);</span><br><span class="line">		<span class="keyword">return</span> properties;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setProperties</span><span class="params">(Properties properties)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.properties = properties;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个类具有 <code>java.util</code>中4种元素类型，并利用 <code>Setter</code> 方式注入值。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/beans/spring-beans.xsd "</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"javaCollection"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.JavaCollection"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"list"</span> &gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">list</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>Russia<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>Canada<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>China<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>China<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- &lt;ref bean="bean-id"&gt; --&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">list</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"set"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">set</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>Russia<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>Canada<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>China<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">value</span>&gt;</span>China<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">set</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"map"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">map</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"1"</span> <span class="attr">value</span>=<span class="string">"Russia"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"2"</span> <span class="attr">value</span>=<span class="string">"Canada"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"3"</span> <span class="attr">value</span>=<span class="string">"China"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">entry</span> <span class="attr">key</span>=<span class="string">"4"</span> <span class="attr">value</span>=<span class="string">"American"</span>&gt;</span><span class="tag">&lt;/<span class="name">entry</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">map</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"properties"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"one"</span> &gt;</span>Russia<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"two"</span> &gt;</span>Canada<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"three"</span>&gt;</span>China<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"four"</span>&gt;</span>Amerian<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">        <span class="comment">&lt;!-- 注入空字符串  --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;property name="email" value="" /&gt; --&gt;</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">&lt;!-- 注入null --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;property name="email"&gt;&lt;null/&gt;&lt;/property&gt; --&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这是 JavaCollection Bean 的配置文件，分别用 <code>&lt;list&gt;</code>, <code>&lt;set&gt;</code>, <code>&lt;map&gt;</code>, <code>&lt;props&gt;</code> 标签传递值。</p>
<p>另外，注意传入 <code>引用</code> ，<code>空字符串</code> 和 <code>null</code> 的方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.AbstractApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.JavaCollection;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CollectionDIDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">"resource"</span>)</span><br><span class="line">		AbstractApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"Beans_collection.xml"</span>);</span><br><span class="line">		JavaCollection collection = (JavaCollection) context.getBean(<span class="string">"javaCollection"</span>);</span><br><span class="line">		collection.getList();</span><br><span class="line">		collection.getSet();</span><br><span class="line">		collection.getMap();</span><br><span class="line">		collection.getProperties();</span><br><span class="line">		context.registerShutdownHook();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>创建 JavaCollection Bean 并初始化 ，然后输出其元素值。</p>
<p>执行输出：</p>
<p><img src="/blog/2019/09/09/Spring入门/CollectionDIDemo-result.png" alt="CollectionDIDemo-result.png"></p>
<p>从输出结果看，成功将4种类型的元素值注入，并且 set 自动去除了重复元素值。</p>
<h2 id="Spring-Beans-Autowire-自动装配"><a href="#Spring-Beans-Autowire-自动装配" class="headerlink" title="Spring Beans Autowire 自动装配"></a>Spring Beans Autowire 自动装配</h2><p><code>&lt;bean&gt;</code> 元素的 <code>autowire</code> 属性可以自动注入属性值，这样可以减少应用程序XML配置的<code>&lt;constructor-arg&gt;</code>, <code>&lt;property&gt;</code>数量。</p>
<p><strong>Autowire Mode</strong></p>
<p>Spring 存在 4 种不同的装配模式，可以使用 <code>&lt;bean&gt;</code> 元素的 <code>autowire</code> 属性来指定装配模式。</p>
<table>
<thead>
<tr>
<th>Autowire Mode</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>no</td>
<td>默认的设置，表示没有自动装配，你应该对bean 显示的布线。</td>
</tr>
<tr>
<td>byName</td>
<td>由属性名自动装配<strong>属性值</strong>。类似 ButterKnife 的注入，类中元素的名称要和 XML 配置文件中的 id 配置一样，即可自动装配。如果不存在或者存在多个相同名称的bean，则会抛出致命异常。</td>
</tr>
<tr>
<td>byType</td>
<td>由属性数据类型自动装配<strong>属性值</strong>。如果不存在或者存在多个相同类型的bean，则会抛出致命异常。</td>
</tr>
<tr>
<td>constructor</td>
<td>类似于 byType ，但该类型适用于<strong>构造函数参数</strong>类型。如果容器中没有一个constructor 参数类型的 bean， 则会抛出致命异常。</td>
</tr>
<tr>
<td>autodetect</td>
<td>首先尝试通过 constructor 来自动装配，再尝试 byType 来自动装配。</td>
</tr>
</tbody></table>
<p><strong>Autowire 的 局限性</strong></p>
<table>
<thead>
<tr>
<th>Limitation</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>重写的可能性</td>
<td>总是可以通过 <code>&lt;constructor-arg&gt;</code> <code>&lt;property&gt;</code>指定依赖关系。</td>
</tr>
<tr>
<td>原始数据类型</td>
<td>不能自动装配所谓的简单类型，包括基本类型，字符串和类。</td>
</tr>
<tr>
<td>混乱的本质</td>
<td>自动装配不如显式装配精确，所以如果可能的话尽可能使用显式装配。</td>
</tr>
</tbody></table>
<p>优点：autowire 可以显著的减少需要指定的属性或构造器参数。</p>
<h3 id="Spring-autowire-ByName"><a href="#Spring-autowire-ByName" class="headerlink" title="Spring autowire ByName"></a>Spring autowire <code>ByName</code></h3><p>2019-09-11 11:41</p>
<p>在配置文件中，如果一个 bean 定义设置为自动装配 <em>byName*，并且它包含 *spellChecker</em> 属性（即，它有一个 <em>setSpellChecker(…)</em> 方法），那么 Spring 就会查找定义名为 <em>spellChecker</em> 的 bean，并且用它来设置这个属性。你仍然可以使用 <code>&lt;property&gt;</code> 标签连接其余的属性。下面的例子将说明这个概念。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span> </span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans </span></span></span><br><span class="line"><span class="tag"><span class="string">	http://www.springframework.org/schema/beans/spring-beans.xsd"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">default-init-method</span>=<span class="string">"initialize"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">default-destroy-method</span>=<span class="string">"destroy"</span> &gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"textEditor"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.TextEditor"</span> <span class="attr">autowire</span>=<span class="string">"byName"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">"spellChecker"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- &lt;property name="autoComplement" ref="autoComplement"&gt;&lt;/property&gt; --&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"spellChecker"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.SpellChecker"</span> &gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"autoComplement"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.AutoComplement"</span> &gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>执行运行正常输出。</p>
<h3 id="Spring-autowire-byType"><a href="#Spring-autowire-byType" class="headerlink" title="Spring autowire byType"></a>Spring autowire <code>byType</code></h3><p>Spring 容器看作 beans，在 XML 配置文件中 beans 的 <em>autowire</em> 属性设置为 <em>byType</em>。然后，如果它的 <strong>type</strong> 恰好与配置文件中 beans 名称中的一个相匹配，它将尝试匹配和连接它的属性。如果找到匹配项，它将注入这些 beans，否则，它将抛出异常。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"textEditor"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.TextEditor"</span> <span class="attr">autowire</span>=<span class="string">"byType"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">"spellChecker"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;property name="autoComplement" ref="autoComplement"&gt;&lt;/property&gt; --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>Spring autowire <code>constructor</code></p>
<p>这种模式与 <em>byType</em> 非常相似，但它应用于构造器参数。Spring 容器看作 beans，在 XML 配置文件中 beans 的 <em>autowire</em> 属性设置为 <em>constructor</em>。然后，它尝试把它的构造函数的参数与配置文件中 beans 名称中的一个进行匹配和连线。如果找到匹配项，它会注入这些 bean，否则，它会抛出异常。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"textEditor"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.TextEditor"</span> <span class="attr">autowire</span>=<span class="string">"constructor"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- &lt;constructor-arg ref="spellChecker"&gt;&lt;/constructor-arg&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"autoComplement"</span> <span class="attr">ref</span>=<span class="string">"autoComplement"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="Spring-基于-annotation-的配置"><a href="#Spring-基于-annotation-的配置" class="headerlink" title="Spring 基于 annotation 的配置"></a>Spring 基于 annotation 的配置</h2><p>2019-09-11 14:13</p>
<p>可以使用注解来配置DI。在执行时，annotation 注入先于 XML 方式注入，因此，共存的 XML 注入会覆盖 annotaion 注入的效果。</p>
<p>使用 annotaion 注入，需要先在 Spring 配置文件中启用。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line">   <span class="comment">&lt;!-- bean definitions go here --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>一旦配置之后，就可以使用 annotaion 注入。几个重要的注解如下：</p>
<table>
<thead>
<tr>
<th>注解</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>@Required</td>
<td>应用于 Setter 方法，XML 配置中必需要存在这个属性值.。deprecated 。</td>
</tr>
<tr>
<td>@Autowired</td>
<td>应用于 bean 属性, Setter，非Setter方法 ， constructor。</td>
</tr>
<tr>
<td>@Qualifier</td>
<td>指定被连线的 bean, 与@Autowired 使用时可以消除混乱。</td>
</tr>
<tr>
<td>JSR-250 Annotation</td>
<td>@PostConstruct, @PreDestroy, @Resource注解。非必需使用。</td>
</tr>
</tbody></table>
<h3 id="Spring-Required-注解"><a href="#Spring-Required-注解" class="headerlink" title="Spring @Required 注解"></a>Spring @Required 注解</h3><p><code>@Required</code> 注释应用于 bean 属性的 setter 方法，它表明受影响的 bean 属性在配置时必须放在 XML 配置文件中，否则容器就会抛出一个 BeanInitializationException 异常。下面显示的是一个使用 @Required 注释的示例。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz.beans;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Required;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SuppressWarnings</span>(<span class="string">"deprecation"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Required</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Required</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Student类具有两个属性，分别在两个 Setter 方法上添加 @Required 注解。<strong>注：</strong>目前 @Required 注解 is deprecated 。原因是没有必要使用它了，@Autowired 注解足以。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 启用基于注解的连线 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- beans definitions go here --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"student"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.Student"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"Alice"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"18"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>配置文件中的 bean 必需配置 @Required 注解标识的属性。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.AbstractApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.Student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnnotationDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">"resource"</span>)</span><br><span class="line">		AbstractApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"Beans_annotation.xml"</span>);</span><br><span class="line">		Student student = (Student) context.getBean(<span class="string">"student"</span>);</span><br><span class="line">		System.out.printf(<span class="string">" Student name: %s, age: %d "</span>, student.getName(), student.getAge());</span><br><span class="line">		context.registerShutdownHook();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行输出：</p>
<p><img src="/blog/2019/09/09/Spring入门/AnnotationRequired-result.png" alt="AnnotationRequired-result.png"></p>
<h3 id="Spring-Autowired-注解"><a href="#Spring-Autowired-注解" class="headerlink" title="Spring @Autowired 注解"></a>Spring @Autowired 注解</h3><p>@Autowired 注解可以用于 bean 属性，Setter 方法， 非 Setter 方法，constructor 方法。</p>
<ol>
<li><p>@Autowired 用于Setter 方法</p>
<p>当对一个 Setter 方法使用 @Autowired 注解时，Spring 会试图执行 <code>byType</code> 自动连接。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tutorialspoint;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TextEditor</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> SpellChecker spellChecker;</span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSpellChecker</span><span class="params">( SpellChecker spellChecker )</span></span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.spellChecker = spellChecker;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> SpellChecker <span class="title">getSpellChecker</span><span class="params">( )</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> spellChecker;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">spellCheck</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      spellChecker.checkSpelling();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>给 Setter 方法添加了 @AutoWired 注解，相当于添加了 <code>byType</code> 模式 autowire 属性。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- Definition for textEditor bean without constructor-arg  --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"textEditor"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.TextEditor"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- Definition for spellChecker bean --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"spellChecker"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.SpellChecker"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>和 autowire 属性 <code>byType</code> 模式 一样，不需要在 textEditor bean 中显示布线指定依赖项 spellChecker。</p>
</li>
<li><p>@Autowired 用于bean属性</p>
<p>可以对 bean 属性使用 <code>@Autowired</code> 注解，<strong>可以消除 Setter 方法</strong> 。应该还是类似于 <code>byType</code> 模式的 autowire 。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tutorialspoint;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TextEditor</span> </span>&#123;</span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> SpellChecker spellChecker;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">TextEditor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      System.out.println(<span class="string">"Inside TextEditor constructor."</span> );</span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="function"><span class="keyword">public</span> SpellChecker <span class="title">getSpellChecker</span><span class="params">( )</span></span>&#123;</span><br><span class="line">      <span class="keyword">return</span> spellChecker;</span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">spellCheck</span><span class="params">()</span></span>&#123;</span><br><span class="line">      spellChecker.checkSpelling();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以看到，这里去掉了 setSpellChecker 方法。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- Definition for textEditor bean --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"textEditor"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.TextEditor"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- Definition for spellChecker bean --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"spellChecker"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.SpellChecker"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>配置文件没有变化。</p>
</li>
<li><p>@Autowired 用于 constructor 方法</p>
<p>也可以在 constructor 中使用 @Autowired。和 <code>constructor</code>模式的 <code>autowire</code> 属性 效果相同。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tutorialspoint;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TextEditor</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> SpellChecker spellChecker;</span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="title">TextEditor</span><span class="params">(SpellChecker spellChecker)</span></span>&#123;</span><br><span class="line">      System.out.println(<span class="string">"Inside TextEditor constructor."</span> );</span><br><span class="line">      <span class="keyword">this</span>.spellChecker = spellChecker;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">spellCheck</span><span class="params">()</span></span>&#123;</span><br><span class="line">      spellChecker.checkSpelling();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里对构造函数添加了 @Autowired 注解。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context/spring-context-3.0.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- Definition for textEditor bean without constructor-arg  --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"textEditor"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.TextEditor"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">   <span class="comment">&lt;!-- Definition for spellChecker bean --&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"spellChecker"</span> <span class="attr">class</span>=<span class="string">"com.tutorialspoint.SpellChecker"</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>配置文件没有变化。</p>
</li>
<li><p>@Autowired 的 (required=false) 选项</p>
<p>默认情况下，@Autowired 注解意味着依赖是必需的，它类似于 @Required 注解。然而，你可以使用 @Autowired 的 <strong>（required=false）</strong> 选项关闭默认行为。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tutorialspoint;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> Integer age;</span><br><span class="line">   <span class="keyword">private</span> String name;</span><br><span class="line">   <span class="meta">@Autowired</span>(required=<span class="keyword">false</span>)</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.age = age;</span><br><span class="line">   &#125;  </span><br><span class="line">   <span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> age;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="meta">@Autowired</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.name = name;</span><br><span class="line">   &#125;   </span><br><span class="line">   <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> name;</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>给 setAge 的 @Autowired 设置了 require=false 选项，因此可以在 XML 配置文件中不配置 age property。</p>
</li>
</ol>
<h3 id="Spring-Qualifier-注解"><a href="#Spring-Qualifier-注解" class="headerlink" title="Spring @Qualifier 注解"></a>Spring @Qualifier 注解</h3><p>当需要创建相同类型的 bean，或者是 bean 的属性中含有多个相同类型的 bean 属性，使用 @Autowired 难免会造成混乱。这种情况下，可以使用 <code>@Qualifier</code> 和 <code>@Autowired</code> 一起使用指定需要装配的 bean，以消除混乱。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz.beans;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz.beans;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Profile</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Autowired</span></span><br><span class="line">	<span class="meta">@Qualifier</span>(<span class="string">"student1"</span>)</span><br><span class="line">	<span class="keyword">private</span> Student student1;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Student1 age is : "</span> + student1.getAge());</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(<span class="string">" Student1 name is : "</span> + student1.getName());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>指定了使用 配置文件中的哪个 Student bean。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">    http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- 启用基于注解的连线 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:annotation-config</span> /&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- beans definitions go here --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"student"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.Student"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"Alice"</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"18"</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"student1"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.Student"</span> &gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">value</span>=<span class="string">"Bob"</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">value</span>=<span class="string">"22"</span> &gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"profile"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.Profile"</span> &gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>主程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.AbstractApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.support.ClassPathXmlApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.Profile;</span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.Student;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AnnotationDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">"resource"</span>)</span><br><span class="line">		AbstractApplicationContext context = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">"Beans_annotation.xml"</span>);</span><br><span class="line">		Student student = (Student) context.getBean(<span class="string">"student"</span>);</span><br><span class="line">		System.out.printf(<span class="string">" Student name: %s, age: %d \n"</span>, student.getName(), student.getAge());</span><br><span class="line">		Profile profile = (Profile) context.getBean(<span class="string">"profile"</span>);</span><br><span class="line">		profile.printName(); profile.printAge();</span><br><span class="line">		context.registerShutdownHook();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行输出：</p>
<p><img src="/blog/2019/09/09/Spring入门/AnnotationDemo-result.png" alt="AnnotationDemo-result.png"></p>
<p>可以看到，结果输出了指定的 Student bean。</p>
<h3 id="Spring-JSR-250-注解"><a href="#Spring-JSR-250-注解" class="headerlink" title="Spring JSR-250 注解"></a>Spring JSR-250 注解</h3><p>包括 <code>@PostConstruct</code>, <code>PreDestory</code>和<code>@Resource</code>。其中，前两个相当于 XML bean属性<code>init-method</code>和<code>destroy-method</code>方法。这里只需要加入注解就可以。</p>
<p>@Resource 注释使用一个 <code>name</code> 属性，该属性以一个 bean 名称的形式被注入。你可以说，它遵循 <strong>by-name</strong> 自动连接语义，如下面的示例所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tutorialspoint;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.Resource;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TextEditor</span> </span>&#123;</span><br><span class="line">   <span class="keyword">private</span> SpellChecker spellChecker;</span><br><span class="line">   <span class="meta">@Resource</span>(name= <span class="string">"spellChecker"</span>)</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSpellChecker</span><span class="params">( SpellChecker spellChecker )</span></span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.spellChecker = spellChecker;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> SpellChecker <span class="title">getSpellChecker</span><span class="params">()</span></span>&#123;</span><br><span class="line">      <span class="keyword">return</span> spellChecker;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">spellCheck</span><span class="params">()</span></span>&#123;</span><br><span class="line">      spellChecker.checkSpelling();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>如果没有明确地指定一个 ‘name’，默认名称源于字段名或者 setter 方法。在字段的情况下，它使用的是字段名；在一个 setter 方法情况下，它使用的是 bean 属性名称。</p>
<h3 id="Spring-基于-Java-的配置"><a href="#Spring-基于-Java-的配置" class="headerlink" title="Spring 基于 Java 的配置"></a>Spring 基于 Java 的配置</h3><p>2019-09-11 18:46</p>
<p>个人理解，基于 Java 的配置就是一种替代 XML 配置文件的方法。根据前面所学，一个 XML 配置文件内包含一个或多个 bean。可以进行 依赖配置 ，注入等。那么用 Java 配置也应该有这些配置方法。</p>
<ol>
<li><p><code>@Configuration</code> ： 用 @Configuration 注解的类表示为一个配置类，相当于 XML配置文件。</p>
</li>
<li><p><code>@Bean</code>：用 @Bean 注解的类表示该类作为一个 Bean 对象，将返回一个 bean 对象。该类将被注册到 Spring 应用程序 Context。最简单可行的 @Configuration 类如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.HelloWorld;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldConfig</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String TAG = HelloWorldConfig.class.getSimpleName();</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">HelloWorldConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println( TAG + <span class="string">" run on constructor. "</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> HelloWorld <span class="title">helloWorld</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println( TAG + <span class="string">" run on helloWorld. "</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> HelloWorld();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>@Configuration 注解表示 HelloWorldConfig 是一个配置类，@Bean 注解表示 helloWorld 将返回一个对象，并且将对象注册到 Spring 应用程序 Context。</p>
<p>主程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.HelloWorld;</span><br><span class="line"><span class="keyword">import</span> com.gthncz.config.HelloWorldConfig;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldConfigDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">"resource"</span>)</span><br><span class="line">		ApplicationContext context = <span class="keyword">new</span> AnnotationConfigApplicationContext(HelloWorldConfig.class);</span><br><span class="line">		HelloWorld helloWorld = (HelloWorld) context.getBean(<span class="string">"helloWorld"</span>); <span class="comment">// id 就是 Configuration 里面 @Bean 的方法名</span></span><br><span class="line">		helloWorld.setMsg(<span class="string">" GT : Hello World !"</span>);</span><br><span class="line">		System.out.println(<span class="string">" Msg : "</span> + helloWorld.getMsg());</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里使用 <code>AnnotationConfigApplicationContext</code> 加载配置类 并提供给 Spring 容器。</p>
<p><strong>注：可以加载各种配置类</strong>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">   AnnotationConfigApplicationContext ctx = </span><br><span class="line">   <span class="keyword">new</span> AnnotationConfigApplicationContext();</span><br><span class="line">   ctx.register(AppConfig.class, OtherConfig.class);</span><br><span class="line">   ctx.register(AdditionalConfig.class);</span><br><span class="line">   ctx.refresh();</span><br><span class="line">   MyService myService = ctx.getBean(MyService.class);</span><br><span class="line">   myService.doStuff();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>相当于将多个配置合并。</p>
<p>执行输出：</p>
<p><img src="/blog/2019/09/09/Spring入门/HelloWorldConfigDemo-result.png" alt="HelloWorldConfigDemo-result.png"></p>
<p>可以看出，Java 配置的方式 和 XML 配置的方式效果相同。</p>
<p><strong>注入 Bean 的依赖</strong></p>
<p>当 @Beans 依赖对方时，表达这种依赖性非常简单，只要有一个 bean 方法调用另一个，如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.tutorialspoint;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.*;</span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppConfig</span> </span>&#123;</span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Foo <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> Foo(bar());</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="meta">@Bean</span></span><br><span class="line">   <span class="function"><span class="keyword">public</span> Bar <span class="title">bar</span><span class="params">()</span> </span>&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">new</span> Bar();</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里是基于 constructor 方式的注入方法。另外，如果是基于 Setter 方式的注入方法，则不需要指定啥。。。如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.AutoComplement;</span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.SpellChecker;</span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.TextEditor;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TextEditorConfig</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> String Tag = TextEditorConfig.class.getSimpleName();</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">TextEditorConfig</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(Tag + <span class="string">" run on constructor. "</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> TextEditor <span class="title">textEditor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(Tag + <span class="string">" run on textEditor. "</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> TextEditor(spellChecker());</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> SpellChecker <span class="title">spellChecker</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(Tag + <span class="string">" run on spellChecker. "</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> SpellChecker();</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@Bean</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> AutoComplement <span class="title">autoComplement</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		System.out.println(Tag + <span class="string">" run on autoComplement. "</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> AutoComplement();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个配置对应于如下的 XML 配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"textEditor"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.TextEditor"</span>&gt;</span></span><br><span class="line">    	<span class="tag">&lt;<span class="name">constructor-arg</span> <span class="attr">ref</span>=<span class="string">"spellChecker"</span>&gt;</span><span class="tag">&lt;/<span class="name">constructor-arg</span>&gt;</span> <span class="comment">&lt;!-- constructor-based DI --&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"spellChecker"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beas.SpellChecker"</span> &gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!-- 注意，这个 autoComplement bean 并没有注入到 textEditor 中，可以使用 autowire 注入 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"autoComplement"</span> <span class="attr">class</span>=<span class="string">"com.gthncz.beans.AutoComplement"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>主程序：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.ApplicationContext;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.AnnotationConfigApplicationContext;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.TextEditor;</span><br><span class="line"><span class="keyword">import</span> com.gthncz.config.TextEditorConfig;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TextEditorConfigDemo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">		<span class="meta">@SuppressWarnings</span>(<span class="string">"resource"</span>)</span><br><span class="line">		ApplicationContext context = <span class="keyword">new</span> AnnotationConfigApplicationContext(TextEditorConfig.class);</span><br><span class="line">		TextEditor textEditor = (TextEditor) context.getBean(<span class="string">"textEditor"</span>);</span><br><span class="line">		textEditor.spellCheck();</span><br><span class="line">		textEditor.autoComplete();  <span class="comment">// 需要设置 @Autowired 注解，否则没有将 AutoComplement 注入到 TextEditor 中，报 NullPointerException</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>执行输出：</p>
<p><img src="/blog/2019/09/09/Spring入门/TextEditorConfigDemo-result.png" alt="TextEditorConfigDemo-result.png"></p>
<p>从输出可以看出，spellChecker 已经被注入到 textEditor 中，但是 autoComplement 没有，因此抛出了 空指针异常。可以为 TextEditor 类中的 autoComplement 属性添加 @Autowired 注解。</p>
</li>
<li><p><code>@Import</code>注解：<strong>@import</strong> 注解允许从另一个配置类中加载 @Bean 定义。</p>
<p>考虑 ConfigA 类，如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfigA</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span> <span class="function"><span class="keyword">public</span> A <span class="title">a</span><span class="params">()</span> return new <span class="title">A</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可以在另一个 Bean 声明中哦你导入上述 Bean 声明，如下所示：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@Import</span>(ConfigA.class)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfigB</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span> <span class="function"><span class="keyword">public</span> B <span class="title">a</span><span class="params">()</span> return new <span class="title">A</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当实例化上下文时，不需要同时指定 ConfigA.class 和 ConfigB.class，只有 ConfigB.class 需要提供：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">   ApplicationContext ctx = </span><br><span class="line">   <span class="keyword">new</span> AnnotationConfigApplicationContext(ConfigB.class);</span><br><span class="line">   <span class="comment">// now both beans A and B will be available...</span></span><br><span class="line">   A a = ctx.getBean(A.class);</span><br><span class="line">   B b = ctx.getBean(B.class);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>生民周期回调</strong></p>
<p>Java 配置方法中 与 XML 配置方法 配置<code>init-method</code> 和 <code>destroy-method</code> 类似的方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> class <span class="title">Foo</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">destroy</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppConfig</span></span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span>(initMethod=<span class="string">"init"</span>, destroyMethod=<span class="string">"destroy"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Foo <span class="title">foo</span><span class="params">()</span> return new <span class="title">Foo</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>Bean Scope</strong></p>
<p>默认的 bean scope 是 <code>singleton</code>，但是可以通过 <code>@Scope</code> 注解指定：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AppConfig</span></span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span>(initMethod=<span class="string">"init"</span>, destroyMethod=<span class="string">"destroy"</span>)</span><br><span class="line">    <span class="meta">@Scope</span>(<span class="string">"prototype"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Foo <span class="title">foo</span><span class="params">()</span> return new <span class="title">Foo</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



</li>
</ol>
<h2 id="Spring-框架-AOP"><a href="#Spring-框架-AOP" class="headerlink" title="Spring 框架 AOP"></a>Spring 框架 AOP</h2><h3 id="基于-AOP-的-XML-架构"><a href="#基于-AOP-的-XML-架构" class="headerlink" title="基于 AOP 的 XML 架构"></a>基于 AOP 的 XML 架构</h3><h3 id="基于-AOP-的-aspectj"><a href="#基于-AOP-的-aspectj" class="headerlink" title="基于 AOP 的 @aspectj"></a>基于 AOP 的 @aspectj</h3><h2 id="Spring-JDBC"><a href="#Spring-JDBC" class="headerlink" title="Spring JDBC"></a>Spring JDBC</h2><h2 id="Spring-Transaction-管理"><a href="#Spring-Transaction-管理" class="headerlink" title="Spring Transaction 管理"></a>Spring Transaction 管理</h2><h3 id="编程式-transaction-管理"><a href="#编程式-transaction-管理" class="headerlink" title="编程式 transaction 管理"></a>编程式 transaction 管理</h3><h3 id="声明式-transaction-管理"><a href="#声明式-transaction-管理" class="headerlink" title="声明式 transaction 管理"></a>声明式 transaction 管理</h3><h2 id="Spring-Web-MVC-框架"><a href="#Spring-Web-MVC-框架" class="headerlink" title="Spring Web MVC 框架"></a>Spring Web MVC 框架</h2><p>2019-09-15 18:00</p>
<p>MVC 各个部分的功能不用多说，和其他的框架是一样的。Spring Web MVC 框架是围绕 <code>DispatcherServlet</code> 构建的。<em>DispatcherServlet</em> 用来处理所有的 HTTP 请求和响应。Spring Web MVC <em>DispatcherServlet</em> 的请求处理的工作流程如下图所示：</p>
<p><img src="/blog/2019/09/09/Spring入门/mvc1.png" alt="mvc1.png"></p>
<p>当一个 Http Request 传入时，处理的流程如下：</p>
<ol>
<li><code>DispatcherServlet</code> 拦截 Http Request，并扫描 <code>WEB-INF</code>下 <code>web.xml</code>文件中 <code>servlet-mapping</code>定义的所有<code>servlet</code>，查找匹配的Servlet，交由该Servlet处理。</li>
<li>根据选择的 servlet，扫描 <code>WEB-INF</code> 下的 <code>&lt;servlet-name&gt;-servlet.xml</code>文件，交由 <code>&lt;context:component-scan /&gt;</code> 扫描得到的 <code>Controller</code> 处理。<em>控制器*接受请求，并基于使用的 <code>GET</code> 或 <code>POST</code> 方法来调用适当的 service 方法。Service 方法将基于定义的业务逻辑设置模型数据，并返回 View 名称到 *DispatcherServlet</em> 中。</li>
<li><em>DispatcherServlet</em> 会从 <code>ViewResolver</code> 获取帮助，为请求检取定义视图。</li>
<li>一旦确定视图，<em>DispatcherServlet</em> 将把模型数据传递给视图，最后呈现在浏览器中。</li>
</ol>
<p>上面所提到的所有组件，即 <code>HandlerMapping</code>、<code>Controller</code> 和 <code>ViewResolver</code> 是 <code>WebApplicationContext</code> 的一部分，而 <em>WebApplicationContext</em> 是带有一些对 web 应用程序必要的额外特性的 <em>ApplicationContext</em> 的扩展。</p>
<h3 id="Spring-MVC-HelloWeb-项目"><a href="#Spring-MVC-HelloWeb-项目" class="headerlink" title="Spring MVC HelloWeb 项目"></a>Spring MVC HelloWeb 项目</h3><p>2019-09-15 18:00</p>
<p>接下创建我们的 HelloWeb 项目，不得不吐槽，W3CSchool 的教程写的太垃圾了。。。看了半天才弄懂怎么搭，接下来我将我搭建的经验写下来。整个项基于 Eclipise IDE。</p>
<ol>
<li><p>创建 <code>Dynamic Web Project</code>  HelloWeb。这里需要安装 eclipse 插件：<code>Eclipse Java EE Developer Tools</code>, <code>Eclipse Java Web Developer Tools</code>，<code>Eclipse Web Developer Tools</code></p>
<p>创建后的项目结构如下：</p>
<p><img src="/blog/2019/09/09/Spring入门/HelloWeb-Project-Structure.png" alt="HelloWeb-Project-Structor.png"></p>
</li>
</ol>
<p>   主要目录说明（参考<a href="https://help.eclipse.org/neon/index.jsp?topic=%2Forg.eclipse.stardust.docs.wst%2Fhtml%2Fwst-integration%2Fdynamic-web-proj.html" target="_blank" rel="noopener">Dynamic Web projects and applications </a>）：</p>
<ul>
<li><p>JavaSource：包含项目的 Java 资源，包括 <code>classes</code>, <code>beans</code>, <code>servlet</code>。当这些资源添加到项目后，将会自动编译并且生成文件添加到 <code>WEB-INF/classes</code> 目录。（然而看起来并没有。。）这些资源目录的内容将不会被打包到 <code>war</code> 文件，除非指定了选项。</p>
</li>
<li><p>WebContent：这是强制的 Web resource 目录，包括 <code>HTML</code>, <code>JSP</code>, <code>graphic files</code> 等等。如果文件不在这个目录下（或者这个目录的子目录下），那么当这个应用在 server 上运行时这些资源将不可用。 WebContent 目录代表着将会部署到 server 上的 <code>war</code> 文件的内容。</p>
</li>
<li><p>META-INF：这个目录包含 <code>MANIFEST.MF</code> 文件，用来映射依赖的 <code>jar</code> 文件的class path。</p>
</li>
<li><p>WEB-INF：这个目录遵守 <em>Sun Microsystems Java Servlet 2.3 Specification</em>，包含 Web 应用的 supporting Web resource，包括 <code>web.xml</code> 以及 <code>classes</code> 和 <code>lib</code> 目录。</p>
</li>
<li><p>/classse：包含 <code>servlet</code>, <code>utility classes</code> 以及 Java Compiler 的输出。</p>
</li>
<li><p>/lib：这个目录包含一些你的 Web 应用的依赖 jar 包。</p>
</li>
<li><p><em>注意：*</em>基于 Maven 的 <code>maven-archetype-webapp</code> 构建的 Web 项目和这里的项目结构不相同。后面将会介绍如何基于 Maven 构建 Web 项目。</p>
</li>
</ul>
<ol start="2">
<li><p>创建一个 <code>servlet</code>和<code>servlet-mapping</code>。在 <code>WEB-INF/web.xml</code>文件内配置，完整文件如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">id</span>=<span class="string">"WebApp_ID"</span> <span class="attr">version</span>=<span class="string">"2.4"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">"http://java.sun.com/xml/ns/j2ee"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/web-app_2_4.xsd "</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">display-name</span>&gt;</span>Spring MVC Project<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloWeb<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span><span class="comment">&lt;!-- 表明哪些URLs将被DispatcherServlet处理 --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>HelloWeb<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span> <span class="comment">&lt;!-- 这个 Servlet 处理的路由 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>创建 Controller。在 <em>Java Resource/src/</em> 下创建package: com.gthncz。创建 <code>HelloController.java</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.ModelMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping</span>(name = <span class="string">"/hello"</span>, method = RequestMethod.GET)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">helloWorld</span><span class="params">(@RequestParam(name = <span class="string">"name"</span>, required = <span class="keyword">false</span>, defaultValue = <span class="string">"World"</span>)</span> String name, ModelMap modal) </span>&#123;</span><br><span class="line">		modal.addAttribute(<span class="string">"message"</span>, <span class="string">"Hello "</span> + name +<span class="string">" !"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"hello"</span>; <span class="comment">// 返回视图名称</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这里的 <code>@Controller</code> 表明这是一个 控制器类。可以写 <code>@Controller(name = &#39;/hello&#39;)</code>，表示这个 控制器下的方法 都在 <code>/hello</code> 这个路径下。 <code>@RequestMapping</code> 表明这是一个 <code>service</code>， <code>method = RequestMethod.GET</code> 属性表示 <code>helloWorld</code> 这个 service 作为 GET 方法默认的 service。同样的，可以定义 POST 默认的处理方法。</p>
<p>在 service 内部可以实现 业务逻辑，并且通过 modelMap 将 message 这个属性传递到 View 中，最后返回一个字符串，内容为 需要渲染的 View 名称。</p>
</li>
<li><p>创建 HelloWeb Servlet的配置文件 <code>WEB-INF/HelloWeb-servlet.xml</code>：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd </span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 激活 Spring MVC的注释功能，可以自动扫描 @Controller @RequestMapping 等注解 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.gthncz"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/hello/"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>这个文件定义了 Java Beans等。利用 <code>context:component-scan</code> 标签将用于激活 Spring MVC 注释扫描功能，该功能允许使用注释，如 <code>@Controller</code> 和 <code>@RequestMapping</code> 等等。<code>InternalResourceViewResolver</code> 将使用定义的规则来解决 View 名称。按照上述定义的规则，一个名称为 <strong>hello</strong> 的逻辑视图将发送给位于 <code>/WEB-INF/jsp/hello.jsp</code> 中实现的视图。</p>
</li>
<li><p>创建 JSP 视图。创建 <code>WEB-INF/hello/hello.jsp</code> 文件：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Spring MVC Project&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;h2&gt;$&#123;message&#125;&lt;/h2&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>对于不同的表示技术，Spring MVC 支持许多类型的视图。这些包括 JSP、HTML、PDF、Excel 工作表、XML、Velocity 模板、XSLT、JSON、Atom 和 RSS 提要、JasperReports 等等。但我们最常使用利用 JSTL 编写的 JSP 模板。其中，<strong>${message}</strong> 是我们在控制器内部设置的属性。你可以在你的视图中有多个属性显示。</p>
</li>
<li><p>将需要的依赖包放到 <code>WEB-INF/lib</code> 目录下，这个工作可以在创建了项目后立即完成。HelloWeb 项目依赖的包有：</p>
<p><img src="/blog/2019/09/09/Spring入门/HelloWeb-lib.png" alt="HelloWeb-lib.png"></p>
</li>
<li><p>最后，利用 eclipse 将项目导出为 <code>war</code> 文件部署到 server 上。</p>
<p>导出方法: <strong>Export</strong>-&gt;<strong>WAR file</strong>。</p>
<p>部署方法：我这里安装的 Tomcat v9.0。webapps 目录在 <code>/usr/share/tomcat/webapps/</code> 。直接将 <code>HelloWeb.war</code> 文件复制到 该目录下即可。Tomcat 默认运行端口为 8080，打卡浏览器运行: <a href="127.0.0.1:8080/HelloWeb/hello" target="_blank" rel="noopener">127.0.0.1:8080/HelloWeb/hello</a>。</p>
<p>看到的效果为：</p>
<p><img src="/blog/2019/09/09/Spring入门/HelloWeb-result.png" alt="HelloWeb-result.png"></p>
</li>
</ol>
<h3 id="Sprin-MVC-表单"><a href="#Sprin-MVC-表单" class="headerlink" title="Sprin MVC 表单"></a>Sprin MVC 表单</h3><p>   2019-09-16  09:23</p>
<p>   接下来完成Spring MVC表单的编写和传值。</p>
<ol>
<li><p>首先，在原有的 HelloWeb 项目下修改。将 HelloController 作为一个独立的访问路径，后面新建的 StudentController 作为另外一个独立的访问路径。修改后下项目结构如下：</p>
<p><img src="/blog/2019/09/09/Spring入门/HelloWeb-Student-proj-structure.png" alt="HelloWeb-Student-proj-structure.png"></p>
<p>修改 HelloWeb-servlet.xml (只是修改了 prefix 的路径)：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns</span>=<span class="string">"http://www.springframework.org/schema/beans"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:context</span>=<span class="string">"http://www.springframework.org/schema/context"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xmlns:xsi</span>=<span class="string">"http://www.w3.org/2001/XMLSchema-instance"</span></span></span><br><span class="line"><span class="tag">	<span class="attr">xsi:schemaLocation</span>=<span class="string">"http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd </span></span></span><br><span class="line"><span class="tag"><span class="string">		http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 激活 Spring MVC的注释功能，可以自动扫描 @Controller @RequestMapping 等注解 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.gthncz"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>修改 HelloController.java，设立独立访问路径：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.ModelMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestParam;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/hello"</span>) <span class="comment">/* 这里不是 name = "/hello"，表示将 hello 加入到 url 中 */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping</span>(value = &#123;<span class="string">""</span>, <span class="string">"/"</span>, <span class="string">"/helloWorld"</span>&#125;, method = RequestMethod.GET)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">helloWorld</span><span class="params">(@RequestParam(name = <span class="string">"name"</span>, required = <span class="keyword">false</span>, defaultValue = <span class="string">"World"</span>)</span> String name, ModelMap modal) </span>&#123;</span><br><span class="line">		modal.addAttribute(<span class="string">"message"</span>, <span class="string">"Hello "</span> + name +<span class="string">" !"</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"hello/hello"</span>; <span class="comment">// 返回视图名称</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>需要注意的是，<code>HelloController</code>的<code>@RequestMapping</code> 属性不是 <code>name = &quot;/hello&quot;</code> , 否则不会起效果。实际上，不写的话，默认属性是 <code>value</code> ， 即 <code>value = &quot;/hello&quot;</code> 应该是起作用的。这里是一种简写的方法，如果有其他属性比如 <code>method = RequestMethod.GET</code>的话，则需要指明属性 <code>value</code>。</p>
<p>另外，由于 <code>hello.jsp</code> 文件位于 <code>/WEB-INF/jsp/hello/hello.jsp</code>，因此在返回视图名称的时候要返回相对于 <code>HelloWeb-servlet</code> 配置的前缀<code>/WEB-INF/jsp/</code>的路径。</p>
<p>本来我的想法是分别使用两个Servlet 完成两种不同的业务逻辑，但是由于 <code>&lt;url-pattern&gt;</code>的不熟悉，放弃了这种方式，改由不同的 <code>Controller</code> 实现业务逻辑的分离。</p>
</li>
<li><p>编写 Beans， StudentController。</p>
<ul>
<li>Student.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz.beans;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Student [name="</span> + name + <span class="string">", age="</span> + age + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>StudentController.java</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.ModelMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ModelAttribute;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.Student;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/student"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping</span>(value = &#123;<span class="string">""</span>, <span class="string">"/"</span>, <span class="string">"/index"</span>&#125;, method = RequestMethod.GET)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> ModelAndView <span class="title">index</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// ModelAndView(String viewName, String modelName, Object modelObject)</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"student/student"</span>, <span class="string">"command"</span>, <span class="keyword">new</span> Student()); </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping</span>(value = <span class="string">"/addStudent"</span>, method = RequestMethod.POST)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">addStudent</span><span class="params">(@ModelAttribute(<span class="string">"SpringWeb"</span>)</span> Student student, ModelMap model) </span>&#123;</span><br><span class="line">		model.addAttribute(<span class="string">"name"</span>, student.getName());</span><br><span class="line">		model.addAttribute(<span class="string">"age"</span>, student.getAge());</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"student/result"</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>StudentController</code>处理独立路径<code>/student</code>下的 service。index() 方法的 @RequestMapping 中属性 <code>value = {&quot;&quot;, &quot;/&quot;, &quot;/index&quot;}</code> 表示这三种 url 路径都将匹配到 index service：/HelloWeb/student, /HelloWeb/student/, /HelloWeb/student/index。</p>
<p>index 传入 具有属性 <code>command</code> ，值为 <code>new Student()</code> 的 model 到前端 student.jsp 文件。<code>@ModelAttriute</code> 用在 service 参数上是为了可以直接从参数上取值，参考 <a href="https://blog.csdn.net/wxgxgp/article/details/81304570" target="_blank" rel="noopener">@ModelAttribute三种使用场景</a>。</p>
</li>
<li><p>编写 视图文件。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span> %&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://www.springframework.org/tags/form"</span> prefix=<span class="string">"form"</span>  %&gt; &lt;!-- 使用 Spring MVC 标签库 --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Add Student&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2&gt;Student Information&lt;/h2&gt;</span><br><span class="line">&lt;form method=<span class="string">"POST"</span> action=<span class="string">"/HelloWeb/student/addStudent"</span>&gt;</span><br><span class="line">	&lt;table&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;&lt;label for="name"&gt;Name&lt;/label&gt;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input name="name" width="100px"/&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;&lt;label for="age"&gt;Age&lt;/label&gt;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input name="age" width="100px" /&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td colspan="2"&gt;&lt;input type="submit" value="Submit" /&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">	&lt;/table&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;hr/&gt;</span><br><span class="line">&lt;form:form method=<span class="string">"POST"</span> action=<span class="string">"#"</span>&gt;</span><br><span class="line">	&lt;!-- 绑定属性的path时候，后端需要传入 Command 对象 --&gt;</span><br><span class="line">	&lt;form:input path=<span class="string">"name"</span> placeholder=<span class="string">"name"</span> width=<span class="string">"120px"</span> type=<span class="string">"text"</span> /&gt;</span><br><span class="line">	&lt;form:input path=<span class="string">"age"</span> placeholder=<span class="string">"18"</span> width=<span class="string">"120px"</span> type=<span class="string">"number"</span>/&gt;</span><br><span class="line">&lt;/form:form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>这里写了两个表单，一个是 HTML 的普通表单，另外一个是 Spring MVC 标签的表单。两个表单的作用相同。</p>
<p>使用 Spring MVC表单的时候，需要声明使用 <code>taglib</code>，否则不起作用：</p>
<figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib uri=<span class="string">"http://www.springframework.org/tags/form"</span> prefix=<span class="string">"form"</span>  %&gt; &lt;!-- 使用 Spring MVC 标签库 --&gt;</span><br></pre></td></tr></table></figure>

<p>还有更多Spring表单标签，参考<a href="https://www.jianshu.com/p/796ec1926150" target="_blank" rel="noopener">Spring MVC的标签库</a>。</p>
<p>页面效果如下：</p>
<p><img src="/blog/2019/09/09/Spring入门/HelloWeb-Student-form.png" alt="HelloWeb-Student-form.png"></p>
<p>下面是提交后的页面：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Submitted Student Information&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2&gt;Submitted Student Information&lt;/h2&gt;</span><br><span class="line">&lt;table&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;Name&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;$&#123;name&#125;&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">    &lt;tr&gt;</span><br><span class="line">        &lt;td&gt;Age&lt;/td&gt;</span><br><span class="line">        &lt;td&gt;$&#123;age&#125;&lt;/td&gt;</span><br><span class="line">    &lt;/tr&gt;</span><br><span class="line">&lt;/table&gt; </span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>页面效果：</p>
<p><img src="/blog/2019/09/09/Spring入门/HelloWeb-Student-form-result.png" alt="HelloWeb-Student-form-result.png"></p>
<p>因此，这里的表单数据可以被正常提交，并可以正确显示。</p>
</li>
</ol>
<h3 id="Spring-页面重定向"><a href="#Spring-页面重定向" class="headerlink" title="Spring 页面重定向"></a>Spring 页面重定向</h3><p>2019-09-16 11:00</p>
<p>页面重定向使用 语句 <code>&quot;redirect:/&lt;controller&gt;/&lt;service&gt;&quot;</code> 实现，service 返回重定向字符串交由 ViewResolver 处理。</p>
<p>下面是一个页面重定向的例子（基于 StudentController 修改）：</p>
<ol>
<li><p>新建 service <code>redirect</code>：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.log4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Controller;</span><br><span class="line"><span class="keyword">import</span> org.springframework.ui.ModelMap;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ModelAttribute;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RequestMethod;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.ModelAndView;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.mvc.support.RedirectAttributes;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.gthncz.beans.Student;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/student"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Logger log = Logger.getLogger(StudentController.class);</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping</span>(value = &#123;<span class="string">""</span>, <span class="string">"/"</span>, <span class="string">"/index"</span>&#125;, method = RequestMethod.GET)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> ModelAndView <span class="title">index</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="comment">// ModelAndView(String viewName, String modelName, Object modelObject)</span></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"student/student"</span>, <span class="string">"command"</span>, <span class="keyword">new</span> Student()); </span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping</span>(value = <span class="string">"/addStudent"</span>, method = &#123; RequestMethod.POST, RequestMethod.GET &#125;)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">addStudent</span><span class="params">(@ModelAttribute Student student, ModelMap model)</span> </span>&#123;</span><br><span class="line">		log.info(<span class="string">"redirected student: "</span> + student.toString());</span><br><span class="line">		model.addAttribute(<span class="string">"name"</span>, student.getName());</span><br><span class="line">		model.addAttribute(<span class="string">"age"</span>, student.getAge());</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"student/result"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="meta">@RequestMapping</span>(value = <span class="string">"/redirect"</span>, method = RequestMethod.POST)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">redirect</span><span class="params">(@ModelAttribute Student student, RedirectAttributes attrs)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// attrs.addAttribute() 使用这个方法会将 参数 附加到 url 的后面，下面这个不会，而是暂存在 session 中</span></span><br><span class="line">		log.info(student.toString());</span><br><span class="line">		attrs.addFlashAttribute(<span class="string">"student"</span>, student);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"redirect:addStudent"</span>; <span class="comment">// 重定向到 addStudent, 重定向过去是 GET 方法</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><em>redirect()</em> 方法 中接收了表单 student 的数据，利用 <code>@ModelAttribute</code> 绑定（自动根据名称绑定）。由于需要将接收到的数据转发出去，使用 <code>RedirectAttributes</code> 存储数据。如果使用<code>attrs.addAttribute()</code> 方法，添加的数据会自动添加在 url 的末尾；而使用 <code>attrs.addFlashAttribute()</code> 方法则是将数据暂存到 <code>session</code> 中，到达 target 后自动销毁，不会附加到 url 末尾。当然，直接将数据附加在 url 末尾也是可以的。</p>
<p>这里直接使用 <code>&quot;redirect:addStudent&quot;</code> 重定向，内部是交由 ViewResolver 处理。也可以使用 <code>new ModelAndView(&quot;redirect:addStudent&quot;)</code> 重定向。</p>
<p><strong>注：</strong>重定向的 status code 为 302，而 target service 接收到的是 一个  GET 方法，因此要 addStudent 的 <code>method</code> 属性要添加一条 <code>RequestMethod.GET</code>。</p>
</li>
<li><p>修改表单 action 地址：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span> %&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://www.springframework.org/tags/form"</span> prefix=<span class="string">"form"</span>  %&gt; &lt;!-- 使用 Spring MVC 标签库 --&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Add Student&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h2&gt;Student Information&lt;/h2&gt;</span><br><span class="line">&lt;form method=<span class="string">"POST"</span> action=<span class="string">"/HelloWeb/student/addStudent"</span>&gt;</span><br><span class="line">	&lt;table&gt;</span><br><span class="line">		&lt;thead&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td colspan=2&gt; Direct post &lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;/thead&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;&lt;label for="name"&gt;Name&lt;/label&gt;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input name="name" width="100px"/&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td&gt;&lt;label for="age"&gt;Age&lt;/label&gt;&lt;/td&gt;</span><br><span class="line">			&lt;td&gt;&lt;input name="age" width="100px" /&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">		&lt;tr&gt;</span><br><span class="line">			&lt;td colspan="2"&gt;&lt;input type="submit" value="Submit" /&gt;&lt;/td&gt;</span><br><span class="line">		&lt;/tr&gt;</span><br><span class="line">	&lt;/table&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;hr/&gt;</span><br><span class="line">&lt;form:form method=<span class="string">"POST"</span> action=<span class="string">"/HelloWeb/student/redirect"</span>&gt;</span><br><span class="line">	&lt;thead&gt;&lt;tr&gt;&lt;td colspan=2&gt;Redirect post&lt;/td&gt;&lt;/tr&gt;&lt;/thead&gt;</span><br><span class="line">	&lt;!-- 绑定属性的path时候，后端需要传入 Command 对象 --&gt;</span><br><span class="line">	&lt;br/&gt;</span><br><span class="line">	&lt;form:input path=<span class="string">"name"</span> placeholder=<span class="string">"name"</span> width=<span class="string">"120px"</span> style=<span class="string">"height: 26px;margin-bottom: 5px ;"</span> type=<span class="string">"text"</span> /&gt; &lt;br/&gt;</span><br><span class="line">	&lt;form:input path="age" placeholder="18" width="120px" style="height: 30px;" type="number"/&gt; &lt;/br&gt;</span><br><span class="line">	&lt;input type=<span class="string">"submit"</span> value=<span class="string">"Submit"</span> /&gt;</span><br><span class="line">&lt;/form:form&gt;</span><br><span class="line"></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>分成了两个表单，上面的表单是直接 POST 到 addStudent 方法；下面这个表单则是 POST 到 redirect 方法。</p>
</li>
<li><p>执行截图：</p>
<p><img src="/blog/2019/09/09/Spring入门/HelloWeb-Student-redirect-index.png" alt="HelloWeb-Student-redirect-index.png"></p>
<p>这是 首页，显示两个表单。下面填写下面这个表单并提交：</p>
<p><img src="/blog/2019/09/09/Spring入门/HelloWeb-Student-redirect-result.png" alt="HelloWeb-Student-redirect-result.png"></p>
<p>可以看到，表单经过重定向 (302) 后交付到 addStudent 。</p>
</li>
</ol>
<h3 id="Spring-MVC-异常处理"><a href="#Spring-MVC-异常处理" class="headerlink" title="Spring MVC 异常处理"></a>Spring MVC 异常处理</h3><p>2019-09-16 15:49</p>
<p>参考<a href="https://blog.csdn.net/eson_15/article/details/51731567" target="_blank" rel="noopener">SpringMVC中的统一异常处理</a>.</p>
<p>系统中异常包括：编译时异常和运行时异常<code>RuntimeException</code>，前者通过捕获异常从而获取异常信息，后者主要通过规范代码开发、测试通过手段减少运行时异常的发生。在开发中，不管是DAO层、Service层还是Controller层，都有可能抛出异常，在Spring MVC中，能将所有类型的异常处理从各处理过程解耦出来，既保证了相关处理过程的功能较单一，也实现了异常信息的统一处理和维护。</p>
<p>这里我使用了 Spring 自带的 <code>SimpleMappingExceptionResolver</code> 来捕获异常的显示：</p>
<ol>
<li><p>定义一个 异常类：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.gthncz;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SpringException</span> <span class="keyword">extends</span> <span class="title">RuntimeException</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> String exceptionMessage;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">SpringException</span><span class="params">(String exceptionMessage)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.exceptionMessage = exceptionMessage;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getExceptionMessage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> exceptionMessage;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setExceptionMessage</span><span class="params">(String exceptionMessage)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.exceptionMessage = exceptionMessage;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>在 <code>StudentController</code> 的 <code>addStudent()</code>  方法上添加 <code>@ExceptionHandler</code> </p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RequestMapping</span>(value = <span class="string">"/addStudent"</span>, method = &#123; RequestMethod.POST, RequestMethod.GET &#125;)</span><br><span class="line"><span class="meta">@ExceptionHandler</span>(&#123; SpringException.class &#125;) <span class="comment">/* 异常处理，可以多个，用‘,’ 分开 */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">addStudent</span><span class="params">(@ModelAttribute Student student, ModelMap model)</span> </span>&#123;</span><br><span class="line">	log.info(<span class="string">"redirected student: "</span> + student.toString());</span><br><span class="line">	<span class="keyword">if</span>(student.getName().length() &lt; <span class="number">1</span>) &#123;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> SpringException(<span class="string">"Given name is too short !"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(student.getAge() &lt; <span class="number">0</span> ) &#123;</span><br><span class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> SpringException(<span class="string">"Given age is illegal !"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	model.addAttribute(<span class="string">"name"</span>, student.getName());</span><br><span class="line">	model.addAttribute(<span class="string">"age"</span>, student.getAge());</span><br><span class="line">	<span class="keyword">return</span> <span class="string">"student/result"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用注解 <code>@ExceptionHandler</code> 表示使用的异常处理器，多个处理器使用 <code>,</code> 分开。为了效果我们内部抛出自定义异常。</p>
</li>
<li><p>在 <code>HelloWeb-servlet.xml</code> 中配置 ExceptionHandler：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 处理异常 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.SimpleMappingExceptionResolver"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 定义默认的异常处理页面 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"defaultErrorView"</span> <span class="attr">value</span>=<span class="string">"error"</span>/&gt;</span> <span class="comment">&lt;!-- /WEB-INF/jsp/error.jsp --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 定义异常处理页面用来获取异常信息的变量名，也可不定义，默认名为exception --&gt;</span> </span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"exceptionAttribute"</span> <span class="attr">value</span>=<span class="string">"exception"</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 定义需要特殊处理的异常，这是重要点 --&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"exceptionMappings"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">props</span>&gt;</span></span><br><span class="line">			<span class="comment">&lt;!-- /WEB-INF/jsp/ExceptionPage.jsp --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"com.gthncz.SpringException"</span>&gt;</span>ExceptionPage<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">props</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 还可以有其他自定义异常 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>声明使用自带的 <code>SimpleMappingExceptionResolver</code>，定义 <code>defaultErrorView</code>, <code>exceptionAttribute</code>, <code>exceptionMappings</code>。</p>
</li>
<li><p>编写 defaul error view page, exception page：</p>
<ul>
<li>error.jsp</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://www.springframework.org/tags/form"</span> prefix=<span class="string">"form"</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Spring Error Page&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;p&gt;An error occured, please contact webmaster.&lt;/p&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>ExceptionPage.jsp</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span>%&gt;</span><br><span class="line">&lt;%@ taglib uri=<span class="string">"http://www.springframework.org/tags/form"</span> prefix=<span class="string">"form"</span> %&gt;</span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta charset=<span class="string">"UTF-8"</span>&gt;</span><br><span class="line">&lt;title&gt;Spring Exception Handling&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;h2&gt;Spring MVC Exception Handling&lt;/h2&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;h3&gt;$&#123;exception.exceptionMessage&#125;&lt;/h3&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>这里的 变量名 <code>exception</code> 在 <code>HelloWeb-servlet.xml</code> 中配置。</p>
</li>
<li><p>执行：</p>
<p><img src="/blog/2019/09/09/Spring入门/HelloWeb-Student-Exception-index.png" alt="HelloWeb-Student-Exception-index.png"></p>
<p>输入 name: GT, Age : -1。根据 addStudent 的 业务逻辑，将会抛出 <code>Given age is illegal !</code> 的异常。</p>
<p><img src="/blog/2019/09/09/Spring入门/HelloWeb-Student-Exception-result.png" alt="HelloWeb-Student-Exception-result.png"></p>
<p>可以看出，抛出的异常被捕获并打印出原因。</p>
</li>
</ol>
<h3 id="Spring-Log4j-的使用"><a href="#Spring-Log4j-的使用" class="headerlink" title="Spring Log4j 的使用"></a>Spring Log4j 的使用</h3><p>2019-09-16 16:07</p>
<p>需要两个jar包：commons-logging.jar，log4j-core.jar 。在需要的类内使用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/student"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>&#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Logger log = Logger.getLogger(StudentController.class);</span><br><span class="line">    <span class="comment">// ...</span></span><br><span class="line">    	<span class="meta">@RequestMapping</span>(value = <span class="string">"/redirect"</span>, method = RequestMethod.POST)</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">redirect</span><span class="params">(@ModelAttribute Student student, RedirectAttributes attrs)</span> </span>&#123;</span><br><span class="line">		<span class="comment">// attrs.addAttribute() 使用这个方法会将 参数 附加到 url 的后面，下面这个不会，而是暂存在 session 中</span></span><br><span class="line">		log.info(student.toString());</span><br><span class="line">		attrs.addFlashAttribute(<span class="string">"student"</span>, student);</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"redirect:addStudent"</span>; <span class="comment">// 重定向到 addStudent, 重定向过去是 GET 方法</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Log4J 还需要在 src 目录下定义配置<code>log4j.properties</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># Define the root logger with appender file</span><br><span class="line">log4j.rootLogger = DEBUG, FILE</span><br><span class="line"></span><br><span class="line"># Define the file appender</span><br><span class="line">log4j.appender.FILE=org.apache.log4j.FileAppender</span><br><span class="line"># Set the name of the file</span><br><span class="line">log4j.appender.FILE.File=/home/gt/Documents/java/HelloWeb/log.out</span><br><span class="line"></span><br><span class="line"># Set the immediate flush to true (default)</span><br><span class="line">log4j.appender.FILE.ImmediateFlush=true</span><br><span class="line"></span><br><span class="line"># Set the threshold to debug mode</span><br><span class="line">log4j.appender.FILE.Threshold=debug</span><br><span class="line"></span><br><span class="line"># Set the append to false, overwrite</span><br><span class="line">log4j.appender.FILE.Append=false</span><br><span class="line"></span><br><span class="line"># Define the layout for file appender</span><br><span class="line">log4j.appender.FILE.layout=org.apache.log4j.PatternLayout</span><br><span class="line">log4j.appender.FILE.layout.conversionPattern=%m%n</span><br></pre></td></tr></table></figure>

<p>当然，也可以使用 commons-logging 的日志功能:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static</span> Log log = LogFactory.getLog(MainApp.class.getName());</span><br><span class="line">log.info(<span class="string">"Going to create HelloWord Obj"</span>);</span><br></pre></td></tr></table></figure>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>2019-09-16 16:17</p>
<p>到此，W3CSchool 上的Spring 入门教程算是学完了。但是感觉这些知识还远远不够将来上手做项目。</p>
<p>现在也完全没有感受到 Spring 框架的便捷性。。倒是那么多的 配置文件 让人觉得头疼。。</p>
<p>现在还有几个问题没有解决：</p>
<ul>
<li>eclipse 中将 war 文件部署到 Tomcat 服务器</li>
</ul>
<p>继续加油学习吧！接下来要学习 Spring Boot框架。</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/blog/tags/Spring-入门/" rel="tag"># Spring 入门</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/blog/2019/09/09/opensuse-failed-to-start-load-module-scsi/" rel="next" title="opensuse failed to start load Kernel modules">
                <i class="fa fa-chevron-left"></i> opensuse failed to start load Kernel modules
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/blog/2019/09/14/eclipse创建maven项目错误/" rel="prev" title="eclipse创建maven项目错误">
                eclipse创建maven项目错误 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">GT</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/blog/archives/">
              
                  <span class="site-state-item-count">33</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">29</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/HTMLgtMK" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:GT_GameEmail@163.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-概述"><span class="nav-number">1.</span> <span class="nav-text">Spring 概述</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-体系结构"><span class="nav-number">2.</span> <span class="nav-text">Spring 体系结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-环境配置"><span class="nav-number">3.</span> <span class="nav-text">Spring 环境配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-Hello-World-实例"><span class="nav-number">4.</span> <span class="nav-text">Spring Hello World 实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-IoC容器"><span class="nav-number">5.</span> <span class="nav-text">Spring IoC容器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-BeanFactory-容器"><span class="nav-number">5.1.</span> <span class="nav-text">Spring BeanFactory 容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ApplicationContext-容器"><span class="nav-number">5.2.</span> <span class="nav-text">ApplicationContext 容器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Bean-定义"><span class="nav-number">5.3.</span> <span class="nav-text">Spring Bean 定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Bean-PostProcessor-后置处理器"><span class="nav-number">5.4.</span> <span class="nav-text">Spring Bean PostProcessor 后置处理器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Bean-定义继承"><span class="nav-number">5.5.</span> <span class="nav-text">Spring Bean 定义继承</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-依赖注入-DI"><span class="nav-number">6.</span> <span class="nav-text">Spring 依赖注入 DI</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Constructor-based-DI"><span class="nav-number">6.1.</span> <span class="nav-text">Spring Constructor-based DI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Setter-based-DI"><span class="nav-number">6.2.</span> <span class="nav-text">Spring Setter-based DI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-注入内部-Beans"><span class="nav-number">6.3.</span> <span class="nav-text">Spring  注入内部 Beans</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-注入集合"><span class="nav-number">6.4.</span> <span class="nav-text">Spring 注入集合</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-Beans-Autowire-自动装配"><span class="nav-number">7.</span> <span class="nav-text">Spring Beans Autowire 自动装配</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-autowire-ByName"><span class="nav-number">7.1.</span> <span class="nav-text">Spring autowire ByName</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-autowire-byType"><span class="nav-number">7.2.</span> <span class="nav-text">Spring autowire byType</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-基于-annotation-的配置"><span class="nav-number">8.</span> <span class="nav-text">Spring 基于 annotation 的配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Required-注解"><span class="nav-number">8.1.</span> <span class="nav-text">Spring @Required 注解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Autowired-注解"><span class="nav-number">8.2.</span> <span class="nav-text">Spring @Autowired 注解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Qualifier-注解"><span class="nav-number">8.3.</span> <span class="nav-text">Spring @Qualifier 注解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-JSR-250-注解"><span class="nav-number">8.4.</span> <span class="nav-text">Spring JSR-250 注解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-基于-Java-的配置"><span class="nav-number">8.5.</span> <span class="nav-text">Spring 基于 Java 的配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-框架-AOP"><span class="nav-number">9.</span> <span class="nav-text">Spring 框架 AOP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基于-AOP-的-XML-架构"><span class="nav-number">9.1.</span> <span class="nav-text">基于 AOP 的 XML 架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基于-AOP-的-aspectj"><span class="nav-number">9.2.</span> <span class="nav-text">基于 AOP 的 @aspectj</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-JDBC"><span class="nav-number">10.</span> <span class="nav-text">Spring JDBC</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-Transaction-管理"><span class="nav-number">11.</span> <span class="nav-text">Spring Transaction 管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#编程式-transaction-管理"><span class="nav-number">11.1.</span> <span class="nav-text">编程式 transaction 管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#声明式-transaction-管理"><span class="nav-number">11.2.</span> <span class="nav-text">声明式 transaction 管理</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Spring-Web-MVC-框架"><span class="nav-number">12.</span> <span class="nav-text">Spring Web MVC 框架</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-MVC-HelloWeb-项目"><span class="nav-number">12.1.</span> <span class="nav-text">Spring MVC HelloWeb 项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sprin-MVC-表单"><span class="nav-number">12.2.</span> <span class="nav-text">Sprin MVC 表单</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-页面重定向"><span class="nav-number">12.3.</span> <span class="nav-text">Spring 页面重定向</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-MVC-异常处理"><span class="nav-number">12.4.</span> <span class="nav-text">Spring MVC 异常处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Spring-Log4j-的使用"><span class="nav-number">12.5.</span> <span class="nav-text">Spring Log4j 的使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#总结"><span class="nav-number">13.</span> <span class="nav-text">总结</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">GT</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    
      <div id="needsharebutton-float">
        <span class="btn">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </span>
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/blog/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/blog/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/blog/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/blog/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/blog/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/blog/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/blog/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/blog/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/blog/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  










  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script src="//unpkg.com/valine/dist/Valine.min.js"></script>
  
  <script type="text/javascript">
    var GUEST = ['nick','mail','link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item=>{
      return GUEST.indexOf(item)>-1;
    });
    new Valine({
        el: '#comments' ,
        verify: false,
        notify: true,
        appId: 'S09XyILBg3oSbx3sz5jNPP6l-gzGzoHsz',
        appKey: 'q2ffoDAS8DlUhqHabJjDu0EW',
        placeholder: 'Just go go',
        avatar:'mm',
        guest_info:guest,
        pageSize:'10' || 10,
    });
  </script>



  





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("S09XyILBg3oSbx3sz5jNPP6l-gzGzoHsz", "q2ffoDAS8DlUhqHabJjDu0EW");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  
  
  
  <link rel="stylesheet" href="/blog/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/blog/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
    
      flOptions = {};
      
          flOptions.iconStyle = "box";
      
          flOptions.boxForm = "horizontal";
      
          flOptions.position = "middleRight";
      
          flOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-float', flOptions);
    
  </script>

  

  

  

  

</body>
</html>
